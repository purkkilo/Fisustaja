(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about~b1bc70ec"],{2226:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("Header",{staticStyle:{"margin-bottom":"60px"}}),t.errors.length?i("div",{attrs:{id:"errordiv"}},[i("ul",{staticClass:"collection with-header",staticStyle:{border:"1px solid red"}},[i("li",{staticClass:"collection-header",staticStyle:{background:"rgba(0,0,0,0)"}},[i("v-alert",{attrs:{type:"error"}},[t._v(" Korjaa seuraavat virheet: ")])],1),t._l(t.errors,(function(e,a){return i("li",{key:a,staticClass:"collection-item",attrs:{id:"error"}},[i("p",{staticClass:"flow-text"},[t._v(t._s(a+1)+". "+t._s(e))])])}))],2)]):t._e(),t.loading?i("div",[i("h2",[t._v("Valmistellaan kilpailua...")]),i("ProgressBarQuery")],1):i("div",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme}},[i("v-row",{staticClass:"valign-wrapper"},[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h1",[t._v("Yleisnäkymä")])]),i("v-col",{attrs:{md:"3"}},[i("div",{staticClass:"text-center"},[i("v-dialog",{scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,s=e.attrs;return[i("p",{class:{"black-text":!t.$store.getters.getTheme,"white-text":t.$store.getters.getTheme}},[t._v(" Kello/Kilpailuaika ")]),i("v-btn",t._g(t._b({attrs:{text:"",outlined:"",color:"red darken-4",dark:""}},"v-btn",s,!1),a),[i("v-icon",[t._v("mdi-timer")])],1)]}}],null,!1,1515809673),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",{staticClass:"headline"}),i("Timedate"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",outlined:""},on:{click:function(e){t.dialog=!1}}},[t._v(" Sulje ")])],1)],1)],1)],1)])],1),i("v-row",[i("v-col",{staticStyle:{"margin-top":"20px"},attrs:{order:"first"}},[i("router-link",{attrs:{to:"/comp-settings"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",rounded:"",color:"grey"}},[i("i",{staticClass:"material-icons left"},[t._v("tune")]),t._v("Määritykset")])],1)],1),i("v-col",{staticStyle:{"margin-top":"20px"}},[i("router-link",{attrs:{to:"/signing"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",rounded:"",color:"blue"}},[i("i",{staticClass:"material-icons left"},[t._v("edit")]),t._v("Ilmoittautuminen")])],1)],1),i("v-col",{staticStyle:{"margin-top":"20px"}},[i("router-link",{attrs:{to:"/weighting"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",rounded:"",color:"blue darken-4"}},[i("i",{staticClass:"material-icons left"},[t._v("fitness_center")]),t._v("Punnitus")])],1)],1),i("v-col",{staticStyle:{"margin-top":"20px"},attrs:{order:"last"}},[i("router-link",{attrs:{to:"/results"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",rounded:"",color:"green"}},[i("i",{staticClass:"material-icons left"},[t._v("emoji_events")]),t._v("Tulokset")])],1)],1)],1),i("div",{staticClass:"divider"}),i("div",{staticClass:"section",class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme}},[i("div",{staticClass:"col s12"},[i("v-card",{attrs:{dark:t.$store.getters.getTheme,elevation:"20",outlined:""}},[i("v-card-title",{staticClass:"text-center"},[i("p",{staticClass:"display-1"},[t._v(" "+t._s(t.competition.name)+" ")])]),i("v-list",{attrs:{outlined:"",elevation:"10"}},[i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-calendar-today")])],1),i("v-list-item-title",[t._v("Päivämäärä")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.formatted_start_date)+" - "+t._s(t.formatted_end_date))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-clock-time-four")])],1),i("v-list-item-title",[t._v("Kilpailuaika")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.competition.start_time)+" - "+t._s(t.competition.end_time))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"green darken-4"}},[t._v("mdi-state-machine")])],1),i("v-list-item-title",[t._v("Tila")]),i("v-list-item-subtitle",{class:{"green-text":"Kaikki maalissa"===t.competition.state,"blue-text":"Kaikki maalissa"!==t.competition.state}},[i("b",[t._v(t._s(t.competition.state))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-card-account-details-outline")])],1),i("v-list-item-title",[t._v("Ilmoittautuneita")]),i("v-list-item-subtitle",{class:{"green-text":t.competition.signees.length,"red-text":!t.competition.signees.length}},[i("b",[t._v(t._s(t.competition.signees.length))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"blue darken-4"}},[t._v("mdi-water-alert")])],1),i("v-list-item-title",[t._v("Vielä vesillä")]),t.competition.signees.length?i("v-list-item-subtitle",{class:{"green-text":!t.competition.signees.length-t.$store.getters.getFinishedSignees.length,"red-text":t.competition.signees.length}},[i("b",[t._v(t._s(t.hasNotReturnedPercentage)+"%")]),t._v(" ("+t._s(t.competition.signees.length-t.$store.getters.getFinishedSignees.length)+" / "+t._s(t.competition.signees.length)+") ")]):i("v-list-item-subtitle",{staticClass:"green-text"},[i("b",[t._v("Ketään ei vielä vesillä!")])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"blue"}},[t._v("mdi-fish")])],1),i("v-list-item-title",[t._v("Saalista saaneita")]),t.competition.signees.length?i("v-list-item-subtitle",{staticClass:"green-text"},[i("b",[t._v(t._s(t.hasGottenFishPercentage)+"%")]),t._v(" ("+t._s(t.$store.getters.getPointSignees.length)+" / "+t._s(t.competition.signees.length)+") ")]):i("v-list-item-subtitle",{staticClass:"red-text"},[i("b",[t._v("Ei vielä ilmoittautuneita!")])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"yellow darken-4"}},[t._v("mdi-seal")])],1),i("v-list-item-title",[t._v("Kalaa saatu yhteensä")]),t.competition.signees.length?i("v-list-item-subtitle",{staticClass:"green-text"},[i("b",[t._v(t._s(t.competition.total_weights/1e3)+" kg")])]):i("v-list-item-subtitle",{staticClass:"red-text"},[i("b",[t._v("Ei vielä ilmoittautuneita!")])])],1)],1)],1)],1)])],1)],1)},s=[],n=(i("99af"),i("96cf"),i("1da1")),o=i("7149"),l=i("b3a7"),r=i("96c7"),c=i("a822"),u={name:"Overview",components:{Timedate:l["default"],ProgressBarQuery:c["default"],Header:r["default"]},data:function(){return{competition:null,loading:!1,errors:[],formatted_start_date:null,formatted_end_date:null,dialog:!1,hasNotReturnedPercentage:0,hasGottenFishPercentage:0}},created:function(){if(null!=localStorage.getItem("competition")){var t=JSON.parse(localStorage.getItem("competition")),e=t["id"];this.refreshCompetition(e)}else console.log("No competition in localstorage!")},mounted:function(){if(this.checkLogin(),location.href="#",location.href="#app",null!=localStorage.getItem("competition")){var t=JSON.parse(localStorage.getItem("competition")),e=t["id"];this.refreshCompetition(e)}else console.log("No competition in localstorage!")},methods:{refreshCompetition:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function i(){var a,s,n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.loading=!0,e.errors=[],i.prev=2,i.next=5,o["a"].getCompetitions({_id:t});case 5:a=i.sent,a?(e.competition=a,e.$store.commit("refreshCompetition",e.competition),localStorage.setItem("cup",e.competition.cup_id),s=e.$moment(e.competition.start_date),n=e.$moment(e.competition.end_date),e.formatted_start_date="".concat(s.date(),".").concat(s.month()+1,".").concat(s.year()),e.formatted_end_date="".concat(n.date(),".").concat(n.month()+1,".").concat(n.year()),e.hasGottenFishPercentage=Math.round(e.$store.getters.getPointSignees.length/e.competition.signees.length*100*100)/100,e.hasNotReturnedPercentage=Math.round((e.competition.signees.length-e.$store.getters.getFinishedSignees.length)/a.signees.length*100*100)/100):e.competition={name:"Kilpailua ei löytynyt tietokannasta..."},i.next=12;break;case 9:i.prev=9,i.t0=i["catch"](2),console.log(i.t0.message);case 12:e.loading=!1;case 13:case"end":return i.stop()}}),i,null,[[2,9]])})))()},checkLogin:function(){if(null!=localStorage.getItem("jwt")){this.$store.state.logged_in=!0;var t=JSON.parse(localStorage.getItem("user"));1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1}else this.$store.state.logged_in=!1,this.$store.state.is_admin=!1}}},d=u,m=i("2877"),h=i("6544"),g=i.n(h),p=i("0798"),_=i("8336"),v=i("b0af"),f=i("99d9"),b=i("62ad"),k=i("a523"),x=i("169a"),w=i("ce7e"),y=i("132d"),S=i("8860"),C=i("da13"),T=i("34c3"),$=i("5d23"),P=i("0fd9"),j=i("2fa4"),V=Object(m["a"])(d,a,s,!1,null,null,null);e["default"]=V.exports;g()(V,{VAlert:p["a"],VBtn:_["a"],VCard:v["a"],VCardActions:f["a"],VCardTitle:f["c"],VCol:b["a"],VContainer:k["a"],VDialog:x["a"],VDivider:w["a"],VIcon:y["a"],VList:S["a"],VListItem:C["a"],VListItemIcon:T["a"],VListItemSubtitle:$["b"],VListItemTitle:$["c"],VRow:P["a"],VSpacer:j["a"]})},"38eb":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},staticStyle:{"margin-top":"70px","margin-bottom":"5px"}},[i("MainHeader"),i("v-row",[i("v-col",[i("v-row",[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h1",[t._v("Kilpailujen tuloksia")])])],1),i("v-row",[i("v-col",{attrs:{md:"3","offset-md":"8"}},[i("router-link",{attrs:{to:"/public-cups"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",rounded:"",color:"blue"}},[i("i",{staticClass:"material-icons left"},[t._v("emoji_events")]),t._v("Cuppien tuloksia ")])],1)],1)],1),t.competitions.length?i("v-row",{staticClass:"scroll_table"},[i("v-col",{attrs:{md:"4","offset-md":"4"}},[i("v-select",{attrs:{dark:t.$store.getters.getTheme,"menu-props":t.$store.getters.getTheme?"dark":"light",items:t.competitions,"item-text":"select","item-value":"_id",label:"Valitse näytettävä kilpailu",loading:t.loading,outlined:"","return-object":"","single-line":""},on:{input:t.pickCompetition},model:{value:t.selected_competition,callback:function(e){t.selected_competition=e},expression:"selected_competition"}})],1)],1):t._e(),i("v-row",[i("v-col",{staticStyle:{"margin-bottom":"20px"},attrs:{md:"3","offset-md":"4"}},[i("v-btn",{attrs:{large:"",tile:"",color:"yellow",disabled:!t.competition},on:{click:function(e){t.competition=null,t.selected_competition=null}}},[i("i",{staticClass:"material-icons left"},[t._v("remove_circle")]),t._v("Peruuta valinta ")])],1),i("v-col",{attrs:{md:"3","offset-md":"1"}},[i("v-dialog",{attrs:{scrollable:"","max-width":"300px"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,s=e.attrs;return[i("v-btn",t._g(t._b({staticClass:"white--text",attrs:{color:"green darken-4",dark:"",large:"",loading:t.loading_competition,disabled:!t.biggest_amounts_results.length||!t.competition}},"v-btn",s,!1),a),[i("i",{staticClass:"material-icons left"},[t._v("picture_as_pdf")]),t._v("Lataa kaikki tulokset ")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[t._v("Valitse mitä lataus sisältää")]),i("v-divider"),i("v-card-text",{staticStyle:{height:"300px",width:"100%"}},[i("v-checkbox",{attrs:{label:"Tilastoja",disabled:!t.biggest_amounts_results.length,color:"indigo darken-3",value:"stats"},model:{value:t.selected_print,callback:function(e){t.selected_print=e},expression:"selected_print"}}),i("v-checkbox",{attrs:{disabled:!t.biggest_amounts_results.length,label:"Normaalikilpailun tulokset",color:"indigo darken-3",value:"normal"},model:{value:t.selected_print,callback:function(e){t.selected_print=e},expression:"selected_print"}}),t.isTeamCompetition?i("v-checkbox",{attrs:{disabled:!t.team_results.length,label:"Tiimikilpailun tulokset",color:"indigo darken-3",value:"team"},model:{value:t.selected_print,callback:function(e){t.selected_print=e},expression:"selected_print"}}):t._e(),i("v-checkbox",{attrs:{disabled:!t.biggest_fishes_results.length,label:"Suurimmat yksittäiset kalat",color:"indigo darken-3",value:"biggest_fishes"},model:{value:t.selected_print,callback:function(e){t.selected_print=e},expression:"selected_print"}}),i("v-checkbox",{attrs:{disabled:!t.biggest_amounts_results.length,label:"Suurimmat kalasaaliit",color:"indigo darken-3",value:"biggest_amounts"},model:{value:t.selected_print,callback:function(e){t.selected_print=e},expression:"selected_print"}}),i("v-checkbox",{attrs:{disabled:!t.biggest_amounts_results.length&&!t.biggest_amounts_results.length,label:"Suurimmat yksittäiset kalat / kalasaaliit (Voittajat)",color:"indigo darken-3",value:"biggest_winners"},model:{value:t.selected_print,callback:function(e){t.selected_print=e},expression:"selected_print"}})],1),i("v-divider"),i("v-card-actions",[i("v-col",[i("v-btn",{attrs:{outlined:"",color:"red darken-4",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("Sulje")])],1),i("v-col",[i("v-btn",{attrs:{outlined:"",color:"green darken-4",text:""},on:{click:t.choosePrints}},[t._v("Lataa")])],1)],1)],1)],1)],1)],1),t.loading?i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Haetaan kilpailuja... ")]),i("ProgressBarQuery")],1)],1):t._e(),i("v-tabs",{attrs:{"background-color":"blue lighten-2",color:"blue darken-4",grow:"","show-arrows":"","next-icon":"mdi-arrow-right-bold-box-outline","prev-icon":"mdi-arrow-left-bold-box-outline","center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tabs-slider",{attrs:{color:"blue darken-4"}}),i("v-tab",{attrs:{href:"#stats"}},[t._v("Tilastoja")]),i("v-tab",{attrs:{href:"#normal-competition",disabled:!t.selected_competition}},[t._v("Normaalikilpailu")]),t.isTeamCompetition?i("v-tab",{attrs:{href:"#team-competition",disabled:!t.selected_competition}},[t._v("Tiimikilpailu")]):i("v-tab",{attrs:{href:"#team-competition",disabled:""}},[t._v("Ei Tiimikilpailua")]),i("v-tab",{attrs:{href:"#biggest-fishes",disabled:!t.selected_competition}},[t._v("Suurimmat Kalat")]),i("v-tab",{attrs:{href:"#biggest-fish-amounts",disabled:!t.selected_competition}},[t._v("Suurimmat Kalasaaliit")])],1),!t.loading&&t.selected_competition?i("v-tabs-items",{staticStyle:{background:"rgba(0,0,0,0.4)"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"stats"}},[i("v-row",{staticStyle:{"padding-top":"50px"}},[i("v-col",{attrs:{md:"3","offset-md":"8"}},[i("v-btn",{staticClass:"white--text",staticStyle:{"margin-bottom":"20px"},attrs:{large:"",tile:"",color:"green darken-4",disabled:!t.biggest_amounts_results.length},on:{click:function(e){return t.saveStatsAsPDF("Tilastoja")}}},[i("i",{staticClass:"material-icons left"},[t._v("picture_as_pdf")]),t._v("Lataa pdf")])],1)],1),t.competition?i("v-row",[t.competition.normal_points.length?i("v-row",{staticStyle:{"min-height":"400px"}},[i("v-col",{staticClass:"d-flex align-content-start",staticStyle:{"margin-bottom":"50px"},attrs:{md:"6"}},[i("div",{staticClass:"chart-container",staticStyle:{position:"relative",height:"30vh",width:"60vw"}},[i("canvas",{attrs:{id:"fishesChart"}})])]),i("v-col",{staticClass:"d-flex align-content-start",attrs:{md:"6"}},[i("div",{staticClass:"chart-container",staticStyle:{position:"relative",height:"30vh",width:"60vw"}},[i("canvas",{attrs:{id:"signeesChart"}})])])],1):i("v-row",[i("v-col",{attrs:{md:"12"}},[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei tuloksia, vielä... ")])])],1)],1):t._e(),t.competition?i("v-row",[i("v-col",{attrs:{md:"8","offset-md":"2"}},[i("v-row",[i("v-col",[i("h3",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Kalalajien määritykset ")])])],1),i("v-row",[i("v-col",{staticClass:"scroll_table"},[i("table",{staticClass:"highlight centered responsive-table table_header",class:{"white--text":t.$store.getters.getTheme},attrs:{id:"fish-weights-table"}},[i("thead",[i("tr",[i("th",[t._v("Kalalaji")]),i("th",[t._v("Pistekerroin")]),i("th",[t._v("Alamitta")]),i("th",[t._v("Punnittu")])])]),i("tbody",[t._l(t.calculated_fish_weights,(function(e,a){return i("tr",{key:a},[i("th",{staticStyle:{border:"1px solid black"},attrs:{scope:"row"}},[t._v(" "+t._s(e.name)+" ")]),i("td",{staticStyle:{border:"1px solid black"}},[t._v(" x "+t._s(e.multiplier)+" ")]),i("td",{staticStyle:{border:"1px solid black"}},[t._v(" "+t._s(e.minsize)+" cm ")]),i("td",{staticStyle:{border:"1px solid black"}},[t._v(" "+t._s(e.weights?Math.round(100*(e.weights/1e3+Number.EPSILON))/100:0)+" kg ")])])})),i("tr",[i("th",{attrs:{scope:"row"}}),i("th"),i("th",{staticStyle:{border:"1px solid black"}},[t._v(" Saalista yhteensä ")]),i("td",{staticStyle:{border:"1px solid black"}},[i("b",[t._v(t._s(Math.round(100*(t.calculated_total_weights/1e3+Number.EPSILON))/100)+" kg")])])])],2)])])],1),i("v-row",[i("v-col",[i("h3",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Yleisiä tilastoja ")])])],1),i("v-row",[i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("table",{staticClass:"centered responsive-table highlight",class:{"white--text":t.$store.getters.getTheme},attrs:{id:"misc-table"}},[i("tr",[i("th",{staticClass:"center-align",staticStyle:{border:"1px solid black"}},[i("b",[t._v("Cup pistekerroin")])]),i("td",{staticClass:"center-align",staticStyle:{border:"1px solid black"}},[i("b",[t._v("x "+t._s(t.competition.cup_points_multiplier))])])]),i("tr",[i("th",{staticClass:"center-align",staticStyle:{border:"1px solid black"}},[i("b",[t._v("Ilmoittautuneita yhteensä")])]),i("td",{staticClass:"center-align",staticStyle:{border:"1px solid black"}},[i("b",[t._v(t._s(t.signees.length))]),t._v(" venettä ")])]),i("tr",[i("th",{staticClass:"center-align",staticStyle:{border:"1px solid black"}},[i("b",[t._v("Saalista saaneita")])]),t.$store.getters.getPointSignees.length?i("td",{staticClass:"center-align",staticStyle:{border:"1px solid black"}},[i("b",[t._v(t._s(Math.round(t.$store.getters.getPointSignees.length/t.competition.signees.length*100*100)/100)+"% ("+t._s(t.$store.getters.getPointSignees.length)+" / "+t._s(t.signees.length)+")")])]):i("td",{staticClass:"center-align",staticStyle:{border:"1px solid black"}},[i("b",[t._v("0% (0/0)")])])])])])],1)],1)],1):t._e()],1),i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"normal-competition"}},[i("v-row",[i("v-col",{staticStyle:{"padding-top":"50px","padding-bottom":"20px"},attrs:{md:"10","offset-md":"1"}},[i("v-row",[i("v-col",{attrs:{md:"4","offset-md":"4"}},[i("v-select",{attrs:{dark:t.$store.getters.getTheme,"menu-props":t.$store.getters.getTheme?"dark":"light",label:"Valitse näytettävät tulokset",outlined:"",items:t.normal_options},on:{input:t.switchNormalResults},model:{value:t.selected_normal,callback:function(e){t.selected_normal=e},expression:"selected_normal"}})],1),t.normal_points.length||t.signees.length&&"Ilmoittautuneet"===t.selected_normal?i("v-col",{attrs:{md:"3","offset-md":"1"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",tile:"",color:"green darken-4",loading:t.loading_competition},on:{click:function(e){t.saveAsPDF("Normaalikilpailun tulokset ("+t.selected_normal+")","#normal-table")}}},[i("i",{staticClass:"material-icons left"},[t._v("picture_as_pdf")]),t._v("Lataa pdf ")])],1):t._e()],1),t.normal_points.length||t.signees.length&&"Ilmoittautuneet"===t.selected_normal?i("v-row",{staticClass:"row"},[i("v-col",{attrs:{md:"12"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text"},[t._v(" Normaalikilpailu ("+t._s(t.selected_normal)+") ")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailijaa","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),i("v-data-table",{attrs:{headers:t.headers,items:t.results,search:t.search},scopedSlots:t._u([{key:"item.placement",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{outlined:t.$store.getters.getTheme,color:t.getColor(a.placement)}},[t._v(t._s(a.placement)+".")])]}},"Ilmoittautuneet"===t.selected_normal?{key:"item.boat_number",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.boat_number))])]}}:null,{key:"item.total_points",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.total_points.toLocaleString())+" p")])]}},{key:"item.cup_points_total",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:t.getColorPoints(a.cup_points_total)}},[t._v(t._s(a.cup_points_total))])]}}],null,!0)})],1)],1)],1):i("v-row",[t.loading?i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tuloksia tietokannasta... ")]),i("ProgressBarQuery")],1):i("v-col",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei tuloksia, vielä... ")])])],1)],1)],1)],1),t.isTeamCompetition?i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"team-competition"}},[t.team_results.length?i("v-row",[i("v-col",{staticStyle:{"padding-top":"50px"},attrs:{md:"3","offset-md":"8"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",tile:"",color:"green darken-4",loading:t.loading_competition},on:{click:function(e){return t.saveAsPDF("Tiimikilpailun tulokset","#team-table")}}},[i("i",{staticClass:"material-icons left"},[t._v("picture_as_pdf")]),t._v("Lataa pdf ")])],1)],1):t._e(),i("v-row",[t.team_results.length?i("v-col",{staticStyle:{"padding-bottom":"20px"},attrs:{md:"10","offset-md":"1"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Tiimikilpailu ")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailijaa","single-line":"","hide-details":""},model:{value:t.search_team,callback:function(e){t.search_team=e},expression:"search_team"}})],1),i("v-data-table",{attrs:{headers:t.team_headers,items:t.team_results,search:t.search_team},scopedSlots:t._u([{key:"item.placement",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{outlined:t.$store.getters.getTheme,color:t.getColor(a.placement)}},[t._v(t._s(a.placement)+".")])]}},{key:"item.points",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.points.toLocaleString())+" p")])]}}],null,!0)})],1)],1):i("v-col",[t.loading?t._e():i("v-col"),t.loading?i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tuloksia tietokannasta... ")]),i("ProgressBarQuery")],1):i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei tuloksia, vielä... ")])],1)],1)],1):t._e(),i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"biggest-fishes"}},[i("v-row",{staticStyle:{"padding-top":"50px"}},[i("v-col",{attrs:{md:"3","offset-md":"4"}},[i("v-select",{attrs:{dark:t.$store.getters.getTheme,"menu-props":t.$store.getters.getTheme?"dark":"light",label:"Valitse näytettävät tulokset",outlined:"",items:t.fish_names},on:{input:t.calculateBiggestFishes},model:{value:t.selected_biggest_fish,callback:function(e){t.selected_biggest_fish=e},expression:"selected_biggest_fish"}})],1),t.biggest_fishes_results.length?i("v-col",{attrs:{md:"3","offset-md":"1"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",tile:"",color:"green darken-4",loading:t.loading_competition},on:{click:function(e){t.saveAsPDF("Suurimmat kalat ("+t.selected_biggest_fish+")","#biggest-fishes-table")}}},[i("i",{staticClass:"material-icons left"},[t._v("picture_as_pdf")]),t._v("Lataa pdf ")])],1):t._e()],1),t.biggest_fishes_results.length?i("v-row",[i("v-col",{staticStyle:{"margin-bottom":"40px"},attrs:{md:"10","offset-md":"1"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[t.results_found_fishes?i("p",{staticClass:"flow-text"},[t._v(" Suurimmat kalat ("+t._s(t.selected_biggest_fish)+" "+t._s(t.results_found_fishes)+") ")]):i("p",{staticClass:"flow-text"},[t._v(" Suurimmat kalat ("+t._s(t.selected_biggest_fish)+") ")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailijaa","single-line":"","hide-details":""},model:{value:t.search_fishes,callback:function(e){t.search_fishes=e},expression:"search_fishes"}})],1),i("v-data-table",{attrs:{headers:t.biggest_fishes_headers,items:t.biggest_fishes_results,search:t.search_fishes},scopedSlots:t._u([{key:"item.placement",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{outlined:t.$store.getters.getTheme,color:t.getColor(a.placement)}},[t._v(t._s(a.placement)+".")])]}},{key:"item.name",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.name))])]}},{key:"item.weight",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.weight.toLocaleString())+" g")])]}}],null,!0)})],1)],1)],1):i("v-row",[t.loading?i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tuloksia tietokannasta... ")]),i("ProgressBarQuery")],1):i("v-col",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei tuloksia, vielä... ")])])],1)],1),i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"biggest-fish-amounts"}},[i("v-row",{staticStyle:{"padding-top":"50px"}},[i("v-col",{attrs:{md:"3","offset-md":"4"}},[i("v-select",{attrs:{dark:t.$store.getters.getTheme,"menu-props":t.$store.getters.getTheme?"dark":"light",label:"Valitse näytettävät tulokset",outlined:"",items:t.fish_amount_names},on:{input:t.calculateBiggestAmounts},model:{value:t.selected_biggest_amount,callback:function(e){t.selected_biggest_amount=e},expression:"selected_biggest_amount"}})],1),t.biggest_amounts_results.length?i("v-col",{attrs:{md:"3","offset-md":"1"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",tile:"",color:"green darken-4",loading:t.loading_competition,disabled:!t.biggest_amounts_results.length},on:{click:function(e){t.saveAsPDF("Suurimmat kalat ("+t.selected_biggest_amount+")","#biggest-amounts-table")}}},[i("i",{staticClass:"material-icons left"},[t._v("picture_as_pdf")]),t._v("Lataa pdf ")])],1):t._e()],1),t.biggest_amounts_results.length?i("v-row",[t._v("> "),i("v-col",[t.results_found_amounts?i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Suurimmat kalasaaliit ("+t._s(t.selected_biggest_amount)+" "+t._s(t.results_found_amounts)+") ")]):i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Suurimmat kalasaaliit ("+t._s(t.selected_biggest_amount)+") ")])])],1):t._e(),t.biggest_amounts_results.length?i("v-row",[i("v-col",{staticStyle:{"margin-bottom":"40px"},attrs:{md:"10","offset-md":"1"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[t.results_found_amounts?i("p",{staticClass:"flow-text"},[t._v(" Suurimmat kalasaaliit ("+t._s(t.selected_biggest_amount)+" "+t._s(t.results_found_amounts)+") ")]):i("p",{staticClass:"flow-text"},[t._v(" Suurimmat kalasaaliit ("+t._s(t.selected_biggest_amount)+") ")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailijaa","single-line":"","hide-details":""},model:{value:t.search_amounts,callback:function(e){t.search_amounts=e},expression:"search_amounts"}})],1),i("v-data-table",{attrs:{headers:t.biggest_amounts_headers,items:t.biggest_amounts_results,search:t.search_amounts},scopedSlots:t._u([{key:"item.placement",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{outlined:t.$store.getters.getTheme,color:t.getColor(a.placement)}},[t._v(t._s(a.placement)+".")])]}},{key:"item.name",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.name))])]}},{key:"item.weight",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.weight.toLocaleString())+" g")])]}}],null,!0)})],1)],1)],1):i("v-row",[t.loading?i("v-col",{attrs:{md:"8","offset-md":"2"}},[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tuloksia tietokannasta... ")]),i("ProgressBarQuery")],1):i("v-col",{attrs:{md:"8","offset-md":"2"}},[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei tuloksia, vielä... ")])])],1)],1)],1):i("v-row",[t.loading_competition||t.loading?t._e():i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Kilpailua ei valittuna ")])])],1),t.competition?i("div",[t.loading_competition?i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tuloksia tietokannasta... ")]),i("ProgressBarQuery")],1)],1):i("v-row",[i("v-col",[i("v-btn",{staticClass:"white--text",attrs:{id:"updatebtn",large:"",tile:"",loading:t.loading_competition,color:"blue darken-4"},on:{click:function(e){return t.refreshCompetition(!0)}}},[i("i",{staticClass:"material-icons left"},[t._v("update")]),t._v("Päivitä tulokset ")])],1)],1)],1):t._e()],1)],1)],1)},s=[],n=(i("99af"),i("4de4"),i("4160"),i("caad"),i("a15b"),i("b0c0"),i("a9e3"),i("35b3"),i("4fad"),i("07ac"),i("ac1f"),i("2532"),i("3ca3"),i("5319"),i("1276"),i("159b"),i("ddb0"),i("b85c")),o=(i("96cf"),i("1da1")),l=i("e683"),r=i("4d5c"),c=i.n(r),u=i("7149"),d=i("a822"),m=i("30ef"),h=i.n(m),g=(i("8521"),i("e511")),p=i.n(g),_=(i("0da4"),regeneratorRuntime.mark(f)),v={name:"PublicResults",components:{ProgressBarQuery:d["default"],MainHeader:l["a"]},data:function(){return{competitions:[],competition:null,selected_competition:null,loading:!1,loading_competition:!1,tab:null,signees:[],fish_names:[],fish_amount_names:[],table_fish_names:[],results:[],normal_points:[],normal_weights:[],team_results:[],biggest_fishes:{},biggest_fishes_results:[],selected_biggest_fish:null,biggest_amounts:{},biggest_amounts_results:[],selected_biggest_amount:null,results_found_fishes:"",results_found_amounts:"",isTeamCompetition:!0,calculated_total_weights:null,calculated_fish_weights:null,selected_normal:null,fishes_chart:null,signees_chart:null,normal_options:["Pisteet","Kalat","Ilmoittautuneet"],headers:[],biggest_fishes_headers:[],biggest_amounts_headers:[],normal_headers:[{text:"Sijoitus",value:"placement"},{text:"Kilp. numero",value:"boat_number"},{text:"Kippari",value:"captain_name"},{text:"Varakippari",value:"temp_captain_name"},{text:"Paikkakunta",value:"locality"},{text:"Tulos",value:"total_points"},{text:"Cup sij. pisteet",value:"cup_placement_points"},{text:"Cup osal. pisteet",value:"cup_participation_points"},{text:"Yht.",value:"cup_points_total"}],signee_headers:[],team_headers:[{text:"Sijoitus",value:"placement"},{text:"Tiimi",value:"name"},{text:"Jäsen 1",value:"captain_name_1"},{text:"Jäsen 2",value:"captain_name_2"},{text:"Jäsen 3",value:"captain_name_3"},{text:"Pisteet",value:"points"}],winner_headers:[{text:"Kalalaji",value:"name"},{text:"Kilp. numero",value:"boat_number"},{text:"Kippari",value:"captain_name"},{text:"Paino",value:"weight"}],biggest_headers:[{text:"Sijoitus",value:"placement"},{text:"Kilp. numero",value:"boat_number"},{text:"Kippari",value:"captain_name"},{text:"Paino",value:"weight"}],search:"",search_team:"",search_fishes:"",search_amounts:"",selected_print:[],dialog:!1}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c.a.AutoInit(),e.prev=1,t.loading=!0,i={isPublic:!0},e.next=6,u["a"].getCompetitions(i);case 6:t.competitions=e.sent,t.competitions.length?(t.competitions.forEach((function(e){e.start_date=t.$moment(e.start_date),e.end_date=t.$moment(e.end_date),e.select="".concat(e.name,", ").concat(e.start_date.year(),"  (").concat(e.cup_name,")")})),t.competitions.sort((function(t,e){return e.start_date.isAfter(t.start_date)})),t.$store.commit("refreshCompetition",t.competition),t.refreshCompetition(!1)):(t.signees=[],t.biggest_fishes=[],t.biggest_amounts=[]),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),console.error(e.t0.message);case 13:t.loading=!1,location.href="#",location.href="#app";case 16:case"end":return e.stop()}}),e,null,[[1,10]])})))()},methods:{getColor:function(t){return t>30?"red":t>20?"orange":t>5?"yellow":"green"},getColorPoints:function(t){return t>5?"primary darken-2":"red"},choosePrints:function(){this.dialog=!1,this.saveAllAsPDF(this.tab)},refreshCompetition:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var a,s,n,o,l;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!e.competition){i.next=15;break}if(e.loading_competition=!0,!t){i.next=7;break}return i.next=5,u["a"].getCompetitions({_id:e.competition._id});case 5:a=i.sent,a&&(e.competition=a,e.$store.commit("refreshCompetition",e.competition));case 7:e.fish_names=[],e.fish_amount_names=[],e.table_fish_names=[],e.selected_print=[],e.signee_headers=[{text:"Kilp. numero",value:"boat_number"},{text:"Kippari",value:"captain_name"},{text:"Varakippari",value:"temp_captain_name"},{text:"Paikkakunta",value:"locality"},{text:"Lähtöpaikka",value:"starting_place"}],s=1;try{e.isTeamCompetition=e.$store.getters.isTeamCompetition,e.signees=e.$store.getters.getResultSignees,e.normal_points=e.competition.normal_points,e.normal_weights=e.competition.normal_weights,e.isTeamCompetition&&(e.signee_headers.push({text:"Tiimi",value:"team"}),e.team_results=e.competition.team_results,n=-1,o=-1,e.team_results.forEach((function(t){n===t.points?t.placement=o:(t.placement=o=s,n=t.points),s++}))),e.biggest_fishes=e.$store.getters.getBiggestFishes,e.biggest_amounts=e.$store.getters.getBiggestAmounts,e.calculated_total_weights=e.$store.getters.getCompetitionTotalWeights,e.calculated_fish_weights=e.competition.fishes,e.selected_normal="Pisteet",l=e.$store.getters.getCompetitionFishes,e.fish_names.push("Voittajat"),e.fish_amount_names.push("Voittajat"),l.forEach((function(t){e.fish_names.push(t.name),e.fish_amount_names.push(t.name),e.table_fish_names.push(t.name)})),e.calculateAll(),e.fishes_chart&&e.signees_chart&&(e.fishes_chart.destroy(),e.signees_chart.destroy()),e.$nextTick((function(){return e.drawCharts(e.tab)})),e.normal_points.length?(e.results=e.normal_points,e.headers=e.normal_headers):(e.results=e.$store.getters.getSignees,e.headers=e.signee_headers,e.selected_normal="Ilmoittautuneet"),t&&c.a.toast({html:"Tiedot ajantasalla!"})}catch(r){console.error(r)}e.loading_competition=!1;case 15:case"end":return i.stop()}}),i)})))()},pickCompetition:function(){this.$store.commit("refreshCompetition",this.selected_competition),this.competition=this.selected_competition,this.refreshCompetition(!1)},drawCharts:function(t){var e=this,i=t,a=[],s=[];this.calculated_fish_weights.forEach((function(t){a.push(t.weights),s.push(t.color)}));var n=[],o=this.$store.getters.getPointSignees.length,l=this.signees.length-o;n.push(o),n.push(l);var r={type:"doughnut",data:{labels:this.table_fish_names,datasets:[{label:"Paino (g)",backgroundColor:s,data:a}]},options:{maintainAspectRatio:!0,responsive:!0,plugins:{labels:{render:function(t){return t.value/(1e3+Number.EPSILON)*100/100+" kg"},fontSize:14,fontStyle:"bold",textShadow:!0,position:"border",textmargin:1,fontColor:"#000",fontFamily:'"Lucida Console", Monaco, monospace'}},title:{display:!0,text:"Kaloja saatu yhteensä",fontSize:28,fontColor:this.$store.getters.getTheme?"white":"black"}}},u={type:"pie",data:{labels:["Kyllä","Ei saalista"],datasets:[{label:"Lukumäärä (kpl)",backgroundColor:["#7fbf7f","#ff7f7f"],data:n}]},options:{maintainAspectRatio:!0,responsive:!0,plugins:{labels:{render:"percentage",fontSize:26,fontStyle:"bold",fontColor:"#000",fontFamily:'"Lucida Console", Monaco, monospace',precision:2}},title:{display:!0,text:"Saalista saaneita",fontSize:28,fontColor:this.$store.getters.getTheme?"white":"black"}}},d=!0;try{var m=document.getElementById("fishesChart").getContext("2d"),g=document.getElementById("signeesChart").getContext("2d")}catch(p){this.tab="stats",d=!1,this.competition.normal_points.length?(setTimeout((function(){return e.drawCharts(i)}),1e3),c.a.toast({html:"Piirretään kaaviot..."})):c.a.toast({html:"Ei tuloksia vielä, joten ei voida piirtää kaavioita..."})}d&&(this.fishes_chart=new h.a(m,r),this.signees_chart=new h.a(g,u),this.tab=i,c.a.toast({html:"Kaaviot piirretty!"}))},checkLogin:function(){if(null!=localStorage.getItem("jwt")){this.$store.state.logged_in=!0;var t=JSON.parse(localStorage.getItem("user"));1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1}else this.$store.state.logged_in=!1,this.$store.state.is_admin=!1},calculateAll:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.calculateBiggestFishes(),t.calculateBiggestAmounts();case 2:case"end":return e.stop()}}),e)})))()},switchNormalResults:function(){var t=this;this.selected_normal||(this.selected_normal="Pisteet"),"Pisteet"===this.selected_normal&&(this.headers=this.normal_headers,this.results=this.normal_points),"Kalat"===this.selected_normal&&(this.headers=[{text:"Sijoitus",value:"placement"},{text:"Kilp. numero",value:"boat_number"},{text:"Kippari",value:"captain_name"}],this.results=this.normal_weights,this.table_fish_names.forEach((function(e){t.headers.push({text:e,value:e})})),this.headers.push({text:"Tulos",value:"total_points"})),"Ilmoittautuneet"===this.selected_normal&&(this.headers=this.signee_headers,this.results=this.$store.getters.getSignees)},sortDict:function(t){if(t){var e=[],i=[];return this.fish_names.forEach((function(a){"Voittajat"!==a&&t[a]&&(i=t[a].sort((function(t,e){return parseInt(e.weight)-parseInt(t.weight)})),t[a]=i.filter((function(t){return t.weight>0})),t[a].length&&e.push({name:a,boat_number:i[0].boat_number,captain_name:i[0].captain_name,weight:i[0].weight.toLocaleString()}))})),e}return[]},calculateBiggestFishes:function(){var t=this.biggest_fishes,e=1;if(this.results_found_fishes=null,this.selected_biggest_fish||(this.selected_biggest_fish="Voittajat"),"Voittajat"===this.selected_biggest_fish)this.biggest_fishes_headers=this.winner_headers,this.biggest_fishes,this.biggest_fishes_results=this.sortDict(t);else{var i=[];this.biggest_fishes_headers=this.biggest_headers,t[this.selected_biggest_fish]?(i=t[this.selected_biggest_fish].sort((function(t,e){return parseInt(e.weight)-parseInt(t.weight)})),this.results_found_amounts=""):this.results_found_fishes="- Ei tuloksia";var a=-1,s=-1;this.biggest_fishes_results=i,this.biggest_fishes_results.forEach((function(t){a===t.weight?t.placement=s:(t.placement=s=e,a=t.weight),e++}))}},calculateBiggestAmounts:function(){var t=this.biggest_amounts,e=1;if(this.results_found_amount="",this.selected_biggest_amount||(this.selected_biggest_amount="Voittajat"),"Voittajat"===this.selected_biggest_amount)this.biggest_amounts_headers=this.winner_headers,this.biggest_amounts,this.biggest_amounts_results=this.sortDict(t);else{this.biggest_amounts_headers=this.biggest_headers;var i=[];t[this.selected_biggest_amount]?(i=t[this.selected_biggest_amount].sort((function(t,e){return parseInt(e.weight)-parseInt(t.weight)})),i=i.filter((function(t){return parseInt(t.weight)>0})),this.results_found_amounts=""):this.results_found_amount="- Ei tuloksia";var a=-1,s=-1;this.biggest_amounts_results=i,this.biggest_amounts_results.forEach((function(t){a===t.weight?t.placement=s:(t.placement=s=e,a=t.weight),e++}))}},replaceAll:function(t,e,i){return t.split(e).join(i)},dictToArray:function(t,e){var i=Object.entries(t),a=[];return i.forEach((function(t){var i=Object.values(t[1]);if(1===e&&(i[0]=String(i[0])+".",i[1]="("+String(i[1])+")",i[5]=i[5].toLocaleString()+" p"),2===e){i[0]=String(i[0])+".",i[1]="("+String(i[1])+")";var s,o=Object(n["a"])(f(3,i.length-2));try{for(o.s();!(s=o.n()).done;){var l=s.value;parseInt(i[l])>0?i[l]=i[l].toLocaleString()+" g":i[l]="-"}}catch(C){o.e(C)}finally{o.f()}i[i.length-1]=i[i.length-1].toLocaleString()+" p"}if(3===e){var r=i[3],c=i[0],u=i[1],d=i[2].toLocaleString()+" g";i[0]=String(r)+".",i[1]="("+String(c)+")",i[2]=u,i[3]=d}if(4===e&&(i[1]="("+String(i[1])+")",i[3]=i[i.length-1].toLocaleString()+" g"),5===e){var m=i[5],h=i[0],g=i[1],p=i[2],_=i[3],v=i[4];i[0]=String(m)+".",i[1]=h,i[2]=g,i[3]=p,i[4]=_,i[5]=v.toLocaleString()+" p"}if(6===e){var b=i[1],k=i[3],x=i[4],w=i[2],y=i[5],S=i[6];i[0]="("+String(b)+")",i[1]=k,i[2]=x,i[3]=w,i[4]=y,i[5]=S}a.push(i)})),a},formatDate:function(t){t=this.$moment(t);var e="".concat(t.date(),".").concat(t.month()+1,".").concat(t.year());return e},capitalize_words:function(t){return t.replace(/(?:^|\s|['`‘’.-])[^\x60^\x7B-\xDF](?!(\s|$))/g,(function(t){return t.toUpperCase()}))},saveAsPDF:function(t,e){this.onbeforeprint();var i,a,s,n=this.formatDate(this.competition.start_date),o=this.formatDate(this.competition.end_date),l=new p.a,r="".concat(this.competition.name),c=n===o?String(n):"".concat(n," - ").concat(o),u="".concat(c,", Klo. ").concat(this.competition.start_time," - ").concat(this.competition.end_time);l.setFontSize(24),l.text(10,10,r,{align:"left"}),l.setFontSize(14),l.text(10,20,this.competition.cup_name,{align:"left"}),l.text(10,30,u,{align:"left"}),l.line(0,35,400,35),l.setFontSize(20),"#normal-table"===e&&(s="Normaalikilpailu".concat(this.selected_normal),"Pisteet"===this.selected_normal&&(a=["Sijoitus","Nro.","Kippari","Varakippari","Paikkakunta","Tulos","Sij. pisteet","Osal. pisteet","Yht."],i=this.dictToArray(this.normal_points,1)),"Kalat"===this.selected_normal&&(a=["Sijoitus","Nro.","Kippari"],this.table_fish_names.forEach((function(t){a.push(t)})),a.push("Tulos"),i=this.dictToArray(this.normal_weights,2)),"Ilmoittautuneet"===this.selected_normal&&(a=["Kilp. numero","Kippari","Varakippari","Paikkakunta","Lähtöpaikka"],this.isTeamCompetition&&a.push("Tiimi"),i=this.dictToArray(this.$store.getters.getSignees,6))),"#team-table"===e&&(s="Tiimikilpailu",a=["Sijoitus","Tiimi","Jäsen 1","Jäsen 2","Jäsen 3","Pisteet"],i=this.dictToArray(this.team_results,5)),"#biggest-fishes-table"===e&&(s="SuurimmatKalat".concat(this.selected_biggest_fish),"Voittajat"===this.selected_biggest_fish?(a=["Kalalaji","Veneen nro","Kippari","Paino"],i=this.dictToArray(this.biggest_fishes_results,4)):(a=["Sijoitus","Veneen nro","Kippari","Paino"],i=this.dictToArray(this.biggest_fishes_results,3))),"#biggest-amounts-table"===e&&(s="SuurimmatSaaliit".concat(this.selected_biggest_amount),"Voittajat"===this.selected_biggest_amount?(a=["Kalalaji","Veneen nro","Kippari","Paino"],i=this.dictToArray(this.biggest_amounts_results,4)):(a=["Sijoitus","Veneen nro","Kippari","Paino"],i=this.dictToArray(this.biggest_amounts_results,3))),l.text(100,50,t,{align:"center"}),l.autoTable({head:[a],body:i,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",startY:55,margin:{top:20}}),l.save("".concat(this.$moment(this.competition.start_date).year(),"_").concat(this.replaceAll(this.competition.name," ",""),"_").concat(s,".pdf")),this.onafterprint()},saveStatsAsPDF:function(t){this.onbeforeprint();var e=this.formatDate(this.competition.start_date),i=this.formatDate(this.competition.end_date),a=new p.a,s="".concat(this.competition.name),n=e===i?String(e):"".concat(e," - ").concat(i),o="".concat(n,", Klo. ").concat(this.competition.start_time," - ").concat(this.competition.end_time);a.setFontSize(24),a.text(10,10,s,{align:"left"}),a.setFontSize(14),a.text(10,20,this.competition.cup_name,{align:"left"}),a.text(10,30,o,{align:"left"}),a.line(0,35,400,35),a.setFontSize(18);var l=document.getElementById("fishesChart").toDataURL("image/png",1),r=document.getElementById("signeesChart").toDataURL("image/png",1);a.addImage(l,"PNG",-30,40,180,90),a.addImage(r,"PNG",70,40,180,90),a.text(100,145,"Kalalajien määritykset",{align:"center"}),a.autoTable({html:"#fish-weights-table",styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",startY:150,margin:{top:20}}),a.text(100,a.autoTable.previous.finalY+20,"Yleisiä tilastoja",{align:"center"}),a.autoTable({html:"#misc-table",styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",margin:{top:20},startY:a.autoTable.previous.finalY+25}),a.save("".concat(this.$moment(this.competition.start_date).year(),"_").concat(this.replaceAll(this.competition.name," ",""),"_").concat(this.replaceAll(this.capitalize_words(t)," ",""),".pdf")),this.onafterprint()},saveAllAsPDF:function(t){var e=this;this.onbeforeprint();var i,a,s,n=t,o=!0,l=this.selected_biggest_fish,r=this.selected_biggest_amount,u=this.selected_normal,d=this.formatDate(this.competition.start_date),m=this.formatDate(this.competition.end_date),h=this.$moment(this.competition.start_date).year(),g=new p.a,_="".concat(this.competition.name),v=d===m?String(d):"".concat(d," - ").concat(m),f="".concat(v,", Klo. ").concat(this.competition.start_time," - ").concat(this.competition.end_time);if(g.setFontSize(24),g.text(10,10,_,{align:"left"}),g.setFontSize(14),g.text(10,20,this.competition.cup_name,{align:"left"}),g.text(10,30,f,{align:"left"}),g.line(0,35,400,35),g.setFontSize(18),this.selected_print.includes("normal")&&(s=["Sijoitus","Nro.","Kippari","Varakippari","Paikkakunta","Tulos","Sij. pisteet","Osal. pisteet","Yht."],a=this.dictToArray(this.normal_points,1),g.text(100,50,"Normaalikilpailun tulokset (Pisteet)",{align:"center"}),g.autoTable({head:[s],body:a,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",startY:55,margin:{top:20}}),g.addPage(),s=["Sijoitus","Nro.","Kippari"],this.table_fish_names.forEach((function(t){s.push(t)})),s.push("Tulos"),a=this.dictToArray(this.normal_weights,2),g.text(100,10,"Normaalikilpailun tulokset (Kalat)",{align:"center"}),g.autoTable({head:[s],body:a,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",margin:{top:20},startY:20})),this.isTeamCompetition&&this.selected_print.includes("team")&&(this.selected_print.includes("normal")&&g.addPage(),g.setFontSize(24),g.text(10,10,_,{align:"left"}),g.setFontSize(14),g.text(10,20,this.competition.cup_name,{align:"left"}),g.text(10,30,f,{align:"left"}),g.line(0,35,400,35),g.setFontSize(18),g.text(100,50,"Tiimikilpailun tulokset",{align:"center"}),this.team_results.length&&(s=["Sijoitus","Tiimi","Jäsen 1","Jäsen 2","Jäsen 3","Pisteet"],a=this.dictToArray(this.normal_points,1),g.autoTable({head:[s],body:a,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",margin:{top:20},startY:55}))),this.selected_print.includes("biggest_fishes")){(this.selected_print.includes("normal")||this.selected_print.includes("team"))&&g.addPage();var b=0;this.table_fish_names.forEach((function(t){e.selected_biggest_fish=t,e.calculateBiggestFishes(),i=10,e.biggest_fishes_results.length&&(b>0&&g.addPage(),g.setFontSize(24),g.text(10,10,_,{align:"left"}),g.setFontSize(14),g.text(10,20,e.competition.cup_name,{align:"left"}),g.text(10,30,f,{align:"left"}),g.line(0,35,400,35),g.setFontSize(18),i=50,s=["Sijoitus","Veneen nro","Kippari","Paino"],a=e.dictToArray(e.biggest_fishes_results,3),g.text(100,i,"Suurimmat kalat"+" (".concat(t,")"),{align:"center"}),g.autoTable({head:[s],body:a,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",margin:{top:20},startY:i+5}),b++)}))}if(this.selected_print.includes("biggest_amounts")){(this.selected_print.includes("normal")||this.selected_print.includes("team")||this.selected_print.includes("biggest_fishes"))&&g.addPage();var k=0;s=["Sijoitus","Veneen nro","Kippari","Paino"],this.table_fish_names.forEach((function(t){e.selected_biggest_amount=t,e.calculateBiggestAmounts(),i=10,e.biggest_amounts[t].length&&(k>0&&g.addPage(),g.setFontSize(24),g.text(10,10,_,{align:"left"}),g.setFontSize(14),g.text(10,20,e.competition.cup_name,{align:"left"}),g.text(10,30,f,{align:"left"}),g.line(0,35,400,35),g.setFontSize(18),i=50,s=["Sijoitus","Veneen nro","Kippari","Paino"],a=e.dictToArray(e.biggest_amounts[t],3),g.text(100,i,"Suurimmat kalasaaliit"+" (".concat(t,")"),{align:"center"}),g.autoTable({head:[s],body:a,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",startY:i+5}),k++)}))}if(this.selected_print.includes("biggest_winners")&&((this.selected_print.includes("normal")||this.selected_print.includes("team")||this.selected_print.includes("biggest_fishes")||this.selected_print.includes("biggest_amounts"))&&g.addPage(),this.selected_biggest_fish=this.selected_biggest_amount="Voittajat",s=["Kalalaji","Veneen nro","Kippari","Paino"],this.calculateBiggestFishes(),this.calculateBiggestAmounts(),(this.biggest_fishes_results.length||this.biggest_amounts_results.length)&&(g.setFontSize(24),g.text(10,10,_,{align:"left"}),g.setFontSize(14),g.text(10,20,this.competition.cup_name,{align:"left"}),g.text(10,30,f,{align:"left"}),g.line(0,35,400,35),g.setFontSize(18)),this.biggest_fishes_results.length?(a=this.dictToArray(this.biggest_fishes_results,4),g.text(100,50,"Suurimmat kalat"+" (".concat(this.selected_biggest_fish,")"),{align:"center"}),g.autoTable({head:[s],body:a,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",margin:{top:20},startY:55}),i=g.autoTable.previous.finalY+25):i=50,this.biggest_amounts_results.length&&(a=this.dictToArray(this.biggest_amounts_results,4),g.text(100,i,"Suurimmat kalasaaliit"+" (".concat(this.selected_biggest_fish,")"),{align:"center"}),g.autoTable({head:[s],body:a,styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",margin:{top:20},startY:i+5}))),this.selected_print.includes("stats")){(this.selected_print.includes("normal")||this.selected_print.includes("team")||this.selected_print.includes("biggest_fishes")||this.selected_print.includes("biggest_amounts")||this.selected_print.includes("biggest_winners"))&&g.addPage(),g.setFontSize(24),g.text(10,10,_,{align:"left"}),g.setFontSize(14),g.text(10,20,this.competition.cup_name,{align:"left"}),g.text(10,30,f,{align:"left"}),g.line(0,35,400,35),g.setFontSize(18);var x=document.getElementById("fishesChart").toDataURL("image/png",1),w=document.getElementById("signeesChart").toDataURL("image/png",1);try{g.addImage(x,"PNG",-30,40,180,90),g.addImage(w,"PNG",70,40,180,90)}catch(y){o=!1,this.tab="stats",setTimeout((function(){return e.saveAllAsPDF(n)}),1e3)}g.text(100,165,"Kalalajien määritykset",{align:"center"}),g.autoTable({html:"#fish-weights-table",styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",startY:170,margin:{top:20}}),g.text(100,g.autoTable.previous.finalY+20,"Yleisiä tilastoja",{align:"center"}),g.autoTable({html:"#misc-table",styles:{overflow:"linebreak",cellWidth:"wrap",rowPageBreak:"avoid",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",margin:{top:20},startY:g.autoTable.previous.finalY+25})}this.selected_biggest_fish=l,this.selected_biggest_amount=r,this.selected_normal=u,this.calculateBiggestFishes(),this.calculateBiggestAmounts(),o?(this.tab=n,g.save("".concat(h,"_").concat(this.replaceAll(this.competition.name," ",""),"Tulokset.pdf"))):c.a.toast({html:"Kaaviot ei ruudulla, yritetään uudelleen..."}),this.onafterprint()},onbeforeprint:function(){var t=i("30ef");for(var e in t.instances){var a=t.instances[e];a.canvas.parentNode.style.height="1000px",a.canvas.parentNode.style.width="2000px",a.resize()}},onafterprint:function(){var t=i("30ef");for(var e in t.instances){var a=t.instances[e];a.canvas.parentNode.style.height="30vh",a.canvas.parentNode.style.width="60vh",a.resize()}}}};function f(t,e){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t;case 2:if(t!==e){i.next=4;break}return i.abrupt("return");case 4:return i.delegateYield(f(t+1,e),"t0",5);case 5:case"end":return i.stop()}}),_)}var b=v,k=i("2877"),x=i("6544"),w=i.n(x),y=i("8336"),S=i("b0af"),C=i("99d9"),T=i("ac7c"),$=i("cc20"),P=i("62ad"),j=i("a523"),V=i("8fea"),F=i("169a"),B=i("ce7e"),K=i("0fd9"),A=i("b974"),I=i("2fa4"),E=i("71a3"),z=i("c671"),L=i("fe57"),N=i("aac8"),D=i("9a96"),W=i("8654"),R=Object(k["a"])(b,a,s,!1,null,null,null);e["default"]=R.exports;w()(R,{VBtn:y["a"],VCard:S["a"],VCardActions:C["a"],VCardText:C["b"],VCardTitle:C["c"],VCheckbox:T["a"],VChip:$["a"],VCol:P["a"],VContainer:j["a"],VDataTable:V["a"],VDialog:F["a"],VDivider:B["a"],VRow:K["a"],VSelect:A["a"],VSpacer:I["a"],VTab:E["a"],VTabItem:z["a"],VTabs:L["a"],VTabsItems:N["a"],VTabsSlider:D["a"],VTextField:W["a"]})},a404:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},staticStyle:{"margin-top":"70px","margin-bottom":"5px"}},[i("MainHeader"),t.errors.length?i("v-row",{attrs:{id:"errordiv"}},[i("ul",{staticClass:"collection with-header",staticStyle:{border:"1px solid red"}},[i("li",{staticClass:"collection-header",staticStyle:{background:"rgba(0,0,0,0)"}},[i("v-alert",{attrs:{type:"error"}},[t._v(" Korjaa seuraavat virheet: ")])],1),t._l(t.errors,(function(e,a){return i("li",{key:a,staticClass:"collection-item",attrs:{id:"error"}},[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" "+t._s(a+1)+". "+t._s(e)+" ")])])}))],2)]):t._e(),i("v-row",{staticClass:"section"},[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h1",[t._v("Cuppien tuloksia")])])],1),i("v-row",[i("v-col",{attrs:{md:"3","offset-md":"8"}},[i("router-link",{attrs:{to:"/public-results"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",rounded:"",color:"green"}},[i("i",{staticClass:"material-icons left"},[t._v("emoji_events")]),t._v("Kilpailujen tuloksia ")])],1)],1)],1),t.cups.length?i("v-row",{staticClass:"scroll_table"},[i("v-col",{attrs:{md:"4","offset-md":"4"}},[i("v-select",{attrs:{"menu-props":t.$store.getters.getTheme?"dark":"light",dark:t.$store.getters.getTheme,items:t.cups,"item-text":"select","item-value":"_id",label:"Valitse näytettävä Cup",outlined:"","return-object":"","single-line":""},on:{input:t.pickCup},model:{value:t.selected_cup,callback:function(e){t.selected_cup=e},expression:"selected_cup"}})],1)],1):i("v-row",[t.loading?i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei cuppeja saatavilla :( ")])]):i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Haetaan cuppeja... ")]),i("ProgressBarQuery")],1)],1),i("v-row",[i("v-col",[i("v-btn",{attrs:{large:"",tile:"",color:"yellow",disabled:!t.selected_cup},on:{click:function(e){t.selected_cup=null,t.competitions=[],t.results=[]}}},[i("i",{staticClass:"material-icons left"},[t._v("remove_circle")]),t._v("Peruuta valinta ")])],1)],1),t.loading?i("v-row",[i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Haetaan cupin kilpailuja... ")]),i("ProgressBarQuery")],1)],1)],1):i("v-row",[i("v-col",[t.results.length?i("v-row",[i("v-col",[i("h1",[t._v("Cupin kokonaispisteet")])])],1):t._e(),t.results.length?i("v-row",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},staticStyle:{"padding-top":"25px"}},[i("v-col",{staticClass:"d-flex",attrs:{md:"4"}},[i("v-select",{attrs:{items:t.header_options,"menu-props":t.$store.getters.getTheme?"dark":"light",dark:t.$store.getters.getTheme,label:"Kilpailun otsikko",outlined:""},on:{input:t.changeHeaders},model:{value:t.header_selection,callback:function(e){t.header_selection=e},expression:"header_selection"}})],1),i("v-col",{staticClass:"d-flex",attrs:{md:"4"}},[i("v-select",{attrs:{"menu-props":t.$store.getters.getTheme?"dark":"light",dark:t.$store.getters.getTheme,items:t.select_numbers,label:"Cup sijoittumispisteisiin vaikuttavien kilpailujen määrä",outlined:""},on:{input:function(e){return t.calculateAll(t.competitions,t.selected_competitions)}},model:{value:t.selected_competitions,callback:function(e){t.selected_competitions=e},expression:"selected_competitions"}})],1),i("v-col",{attrs:{md:"4"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",tile:"",color:"green darken-4",loading:t.loading},on:{click:function(e){return t.saveAsPDF("Cupin Kokonaistulokset")}}},[i("i",{staticClass:"material-icons left"},[t._v("picture_as_pdf")]),t._v("Lataa pdf ")])],1)],1):t._e(),t.results.length&&t.not_finished_count>0?i("v-row",[i("v-col",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" *Punaisella merkityt kilpailut ovat vielä kesken! ("+t._s(t.not_finished_count)+" kpl) ")])])],1):t._e(),t.competitions.length?i("v-row",[i("v-col",[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text"},[t._v("Cupin kokonaispisteet")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailijaa","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),i("v-data-table",{attrs:{id:"normal-table",headers:t.headers,items:t.results,search:t.search},scopedSlots:t._u([t._l(t.headers,(function(e,a){return{key:"header."+e.value,fn:function(e){var s=e.header;return[s.highlight?i("v-chip",{key:a,attrs:{outlined:t.$store.getters.getTheme,color:t.getCompetitionFinishedColor(s.isFinished)}},[t._v(t._s(s.text))]):i("v-chip",{key:a,attrs:{outlined:t.$store.getters.getTheme}},[t._v(t._s(s.text))])]}}})),{key:"item.final_placement",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{outlined:t.$store.getters.getTheme,color:t.getColor(a.final_placement)}},[t._v(t._s(a.final_placement)+".")])]}},t._l(t.competitions.length,(function(e,a){return{key:"item.cup_results["+e+"].points",fn:function(s){var n=s.item;return[n.cup_results[e]?i("div",{key:e},[n.cup_results[e].points===t.competitions[a].cup_participation_points?i("span",[t._v(t._s(n.cup_results[e].points)+"p ("+t._s(n.cup_results[e].placement)+".)")]):i("v-chip",{attrs:{outlined:t.$store.getters.getTheme,color:t.getColor(n.cup_results[e].placement)}},[t._v(t._s(n.cup_results[e].points)+"p ("+t._s(n.cup_results[e].placement)+".)")])],1):i("span",{key:e},[t._v(" - ")])]}}})),{key:"item.final_cup_points",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:"indigo darken-3 white--text"}},[t._v(t._s(a.final_cup_points)+"p")])]}}],null,!0)})],1)],1)],1):t._e(),t.competitions.length&&t.selected_cup?i("v-row",[t.loading?i("v-col",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tuloksia... ")])]):t._e()],1):t._e(),t.competitions.length&&t.selected_cup?i("v-row",[i("v-col",[i("v-btn",{staticClass:"white--text",attrs:{id:"updatebtn",large:"",tile:"",loading:t.loading,color:"blue darken-4"},on:{click:function(e){return t.refreshCup(t.selected_cup)}}},[i("i",{staticClass:"material-icons left"},[t._v("update")]),t._v("Päivitä cupin tulokset ")])],1)],1):i("v-row",[i("v-col",[t.selected_cup&&!t.competitions.length?i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Cupissa ei vielä kilpailuja! ")]):t._e(),t.selected_cup?t._e():i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Cuppia ei vielä valittuna! ")])])],1)],1)],1)],1)},s=[],n=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("a15b"),i("d81d"),i("fb6a"),i("a434"),i("b0c0"),i("4fad"),i("07ac"),i("ac1f"),i("5319"),i("1276"),i("159b"),i("2909")),o=(i("96cf"),i("1da1")),l=i("4d5c"),r=i.n(l),c=i("51dd"),u=i("7149"),d=i("e511"),m=i.n(d),h=(i("0da4"),i("e683")),g=i("a822"),p={name:"PublicCups",components:{ProgressBarQuery:g["default"],MainHeader:h["a"]},data:function(){return{cup:null,cups:[],competitions:[],headers:[],results:[],loading:!1,errors:[],select_numbers:[],header_options:["Paikkakunta","Kilpailun nimi"],header_selection:"Paikkakunta",selected_competitions:0,selected_cup:null,tab:null,search:"",not_finished_count:0}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.checkLogin(),e.next=3,c["a"].getCups({isPublic:!0});case 3:t.cups=e.sent,t.cups.length&&t.cups.forEach((function(t){t.select="".concat(t.name," (").concat(t.year,")")})),location.href="#",location.href="#app";case 7:case"end":return e.stop()}}),e)})))()},methods:{pickCup:function(){this.refreshCup(this.selected_cup)},calculateAll:function(t,e){var i=this,a=[];if(this.isResults=!1,t.forEach((function(t){t.normal_points.length&&t.normal_points.forEach((function(e){var s=a.findIndex((function(t){return parseInt(e.boat_number)===parseInt(t.boat_number)}));if(s>-1){var n=a[s];n.points_compare.push(e.cup_points_total),n.cup_results[t.key_name]={points:e.cup_points_total,placement:e.placement},a.splice(s,1,n)}else{var o=i.selected_cup.signees.find((function(t){return t.boat_number===e.boat_number}));e.captain_name=o.captain_name,e.temp_captain_name=o.temp_captain_name,e.locality=o.locality,e.cup_results=[],e.points_compare=[],e.points_compare.push(e.cup_points_total),e.cup_results[t.key_name]={points:e.cup_points_total,placement:e.placement},a.push(e)}}))})),a.length){this.isResults=!0,a=this.limitCompetitions(a,e),this.results=a.sort((function(t,e){return parseInt(e.cup_results["Total"])-parseInt(t.cup_results["Total"])})),this.changeHeaders();var s=1,n=-1,o=-1;this.results.forEach((function(t){n===t.cup_results["Total"]?t.final_placement=o:(t.final_placement=s,n=t.cup_results["Total"],o=t.final_placement),t.final_cup_points=t.cup_results["Total"],s++}))}},limitCompetitions:function(t,e){var i=this;return e=e<0?0:e,t.forEach((function(t){if(i.competitions.length>=e){t.points_compare.sort((function(t,e){return parseInt(e)-parseInt(t)})),t.cup_results["Total"]=0;var a=0;i.competitions.forEach((function(i){t.cup_results[i.key_name]&&(t.cup_results[i.key_name].placement=i.normal_points.find((function(e){return e.boat_number===t.boat_number})).placement,t.cup_results[i.key_name].points<t.points_compare[e]&&(t.cup_results[i.key_name].points=i.cup_participation_points),t.cup_results[i.key_name].points===t.points_compare[e]&&(1!==a&&(t.cup_results[i.key_name].points=i.cup_participation_points),a++))}))}t.cup_results.forEach((function(e){t.cup_results["Total"]+=e.points}))})),t},refreshCup:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.loading=!0,e.errors=[],e.$store.commit("refreshCup",t),i.prev=3,i.next=6,u["a"].getCompetitions({cup_id:t.id});case 6:e.competitions=i.sent,a=1,e.competitions=e.competitions.filter((function(t){return t.isPublic})),e.competitions.forEach((function(t){e.select_numbers.push(a),t.start_date=e.$moment(t.start_date),t.end_date=e.$moment(t.end_date),t.key_name=a,a++})),e.competitions.sort((function(t,e){return e.start_date.isBefore(t.start_date)})),e.selected_competitions=e.competitions.length,e.calculateAll(e.competitions,e.selected_competitions),r.a.toast({html:"Tiedot ajantasalla!"}),e.loading=!1,i.next=21;break;case 17:i.prev=17,i.t0=i["catch"](3),e.loading=!1,console.error(i.t0);case 21:case"end":return i.stop()}}),i,null,[[3,17]])})))()},checkLogin:function(){if(null!=localStorage.getItem("jwt")){this.$store.state.logged_in=!0;var t=JSON.parse(localStorage.getItem("user"));1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1}else this.$store.state.logged_in=!1,this.$store.state.is_admin=!1},getColor:function(t){return t>30?"red":t>20?"orange":t>5?"yellow":"green"},getCompetitionFinishedColor:function(t){return t?"red":"primary"},replaceAllChars:function(t,e){return Object(n["a"])(t).map((function(t){for(var i in e)t==i&&(t=e[i]);return t})).join("")},changeHeaders:function(){var t=this;this.headers=[],this.headers.push({text:"Sijoitus",highlight:!1,align:"center",value:"final_placement"}),this.headers.push({text:"Kilp. Nro",align:"center",highlight:!1,value:"boat_number"}),this.headers.push({text:"Kippari",align:"center",highlight:!1,value:"captain_name"}),this.headers.push({text:"Paikkakunta",align:"center",highlight:!1,value:"locality"}),this.not_finished_count=0,this.competitions.forEach((function(e){if(e.isFinished||t.not_finished_count++,"Paikkakunta"===t.header_selection){var i=t.headers.filter((function(t){return e.locality===t.text}));if(i.length){var a=" ".concat(e.locality," #").concat(i.length+1);t.headers.push({text:a,align:"center",highlight:!0,isFinished:!e.isFinished,value:"cup_results[".concat(e.key_name,"].points")})}else t.headers.push({text:e.locality,align:"center",highlight:!0,isFinished:!e.isFinished,value:"cup_results[".concat(e.key_name,"].points")})}else t.headers.push({text:e.name,align:"center",highlight:!0,isFinished:!e.isFinished,value:"cup_results[".concat(e.key_name,"].points")})})),this.headers.push({text:"Yhteensä",align:"center",highlight:!1,value:"final_cup_points"})},pickCompetition:function(t){this.$store.state.competition=t,localStorage.setItem("competition",JSON.stringify({id:t._id,start_date:t.start_date,end_date:t.end_date})),this.$router.push({path:"/overview"})},replaceAll:function(t,e,i){return t.split(e).join(i)},capitalize_words:function(t){return t.replace(/(?:^|\s|['`‘’.-])[^\x60^\x7B-\xDF](?!(\s|$))/g,(function(t){return t.toUpperCase()}))},dictToArray:function(t){var e=this,i=Object.entries(t),a=[];return i.forEach((function(t){var i=Object.values(t[1]),s=i[9];i[0]=String(i[11])+".",i[1]="("+String(i[1])+")",i[3]=i[4];var n=4;e.competitions.forEach((function(t){s[t.key_name]?i[n]="".concat(s[t.key_name].points,"p (").concat(s[t.key_name].placement,".)"):i[n]="-",n++})),i[n]="".concat(s["Total"],"p"),a.push(i)})),a},saveAsPDF:function(t){var e;e=this.competitions.length>4?new m.a("landscape"):new m.a;var i,a,s,o="".concat(this.selected_cup.name," (").concat(this.selected_cup.year,")"),l=[],r=Object(n["a"])(this.competitions),c=r.slice().reverse().findIndex((function(t){return!0===t.isFinished})),u=r.length-1,d=c>=0?u-c:c,h=r[d],g=this.$moment(h.start_date),p="".concat(g.date(),".").concat(g.month()+1,".").concat(g.year());e.setFontSize(24),e.text(13,15,o,{align:"left"}),e.line(0,20,400,20),e.setFontSize(14);var _=0;this.competitions.forEach((function(t){t.isFinished?0:_++})),i=0===_?"Tulokset ".concat(p):"Tilanne ".concat(p,", ").concat(h.name," (").concat(h.locality,") jälkeen (").concat(_," kpl kilpailuja kesken)"),e.text(13,30,i,{align:"left"}),e.text(13,40,t+" (".concat(this.selected_competitions,"/").concat(this.competitions.length," parasta kilpailua otettu huomioon)"),{align:"left"}),this.headers.forEach((function(t){l.push(t.text)})),a=this.dictToArray(this.results,1),s=45,e.autoTable({head:[l],body:a,styles:{overflow:"linebreak",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},headStyles:{text:{cellwidth:"wrap"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",startY:s,margin:{top:20}}),e.save("".concat(this.selected_cup.year,"_").concat(this.replaceAll("Cup"," ",""),"_").concat(this.replaceAll(this.capitalize_words(t)," ",""),".pdf"))}}},_=p,v=(i("c289"),i("2877")),f=i("6544"),b=i.n(f),k=i("0798"),x=i("8336"),w=i("b0af"),y=i("99d9"),S=i("cc20"),C=i("62ad"),T=i("a523"),$=i("8fea"),P=i("0fd9"),j=i("b974"),V=i("2fa4"),F=i("8654"),B=Object(v["a"])(_,a,s,!1,null,"61ca3724",null);e["default"]=B.exports;b()(B,{VAlert:k["a"],VBtn:x["a"],VCard:w["a"],VCardTitle:y["c"],VChip:S["a"],VCol:C["a"],VContainer:T["a"],VDataTable:$["a"],VRow:P["a"],VSelect:j["a"],VSpacer:V["a"],VTextField:F["a"]})},a55b:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("MainHeader"),i("div",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},staticStyle:{"margin-top":"100px"}},[i("v-container",[t.errors.length?i("div",{attrs:{id:"errordiv"}},[i("ul",{staticClass:"collection with-header",staticStyle:{border:"1px solid red"}},[i("li",{staticClass:"collection-header",staticStyle:{background:"rgba(0,0,0,0)"}},[i("v-alert",{attrs:{type:"error"}},[t._v(" Korjaa seuraavat virheet: ")])],1),t._l(t.errors,(function(e,a){return i("li",{key:a,staticClass:"collection-item",attrs:{id:"error"}},[i("p",{staticClass:"flow-text"},[t._v(t._s(a+1)+". "+t._s(e))])])}))],2)]):t._e(),i("h1",[t._v("Login")]),i("form",[i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"8","offset-md":"2"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,id:"email",label:"Sähköpostiosoite",type:"email",maxlength:"40",loading:t.loading,counter:40},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"8","offset-md":"2"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Salasana",id:"password",type:"password",maxlength:"40",loading:t.loading,counter:40},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t.loading?i("v-row",[i("ProgressBarQuery",{staticStyle:{"margin-bottom":"20px"}})],1):i("v-row",[i("v-col",[i("v-btn",{staticClass:"white--text",attrs:{id:"sbtn",large:"",tile:"",color:"blue darken-4"},on:{click:t.handleSubmit}},[i("i",{staticClass:"material-icons left"},[t._v("login")]),t._v("Kirjaudu ")])],1)],1)],1)])],1)],1)},s=[],n=(i("b0c0"),i("96cf"),i("1da1")),o=i("4d5c"),l=i.n(o),r=i("3faa"),c=i("e683"),u=i("a822"),d={data:function(){return{errors:[],email:null,password:null,loading:!1}},components:{MainHeader:c["a"],ProgressBarQuery:u["default"]},mounted:function(){var t=document.getElementById("password");t.addEventListener("keyup",(function(t){13===t.keyCode&&(t.preventDefault(),document.getElementById("sbtn").click())})),location.href="#",location.href="#app"},methods:{showError:function(t){this.errors.push(t),l.a.toast({html:t}),location.href="#",location.href="#app"},handleSubmit:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.preventDefault(),e.errors=[],e.email||e.showError("Syötä sähköposti!"),e.password||e.showError("Syötä salasana!"),e.errors.length){i.next=17;break}return e.loading=!0,a={email:e.email,password:e.password},i.prev=7,i.next=10,r["a"].loginUser(a).then((function(t){var i=JSON.stringify(t.data.user.is_admin);e.$store.state.is_admin=i;var a=t.data.user.preferences;a||(a={isDark:!0,lang:"fi"}),localStorage.setItem("user",JSON.stringify({id:t.data.user._id,name:t.data.user.name,email:t.data.user.email,is_admin:t.data.user.is_admin,createdAt:t.data.user.createdAt,preferences:a})),e.$store.state.isDark=a.isDark,e.$store.state.lang=a.lang,localStorage.setItem("jwt",t.data.token),e.$store.state.logged_in=!0,null!=localStorage.getItem("jwt")&&(e.$emit("loggedIn"),null!=e.$route.params.nextUrl?e.$router.push(e.$route.params.nextUrl):e.$router.push({path:"/dashboard"})),e.loading=!1})).catch((function(t){return t.response?401===t.response.status||404===t.response.status?(e.loading=!1,void e.showError("Käyttäjänimi tai salasana ei täsmää!")):(e.loading=!1,console.log(t)):console.log(t)}));case 10:i.next=17;break;case 12:i.prev=12,i.t0=i["catch"](7),console.log(i.t0),e.showError("Näillä tiedoilla ei löytynyt käyttäjää!"),e.$router.push({path:"/login"});case 17:case"end":return i.stop()}}),i,null,[[7,12]])})))()}}},m=d,h=i("2877"),g=i("6544"),p=i.n(g),_=i("0798"),v=i("8336"),f=i("62ad"),b=i("a523"),k=i("0fd9"),x=i("8654"),w=Object(h["a"])(m,a,s,!1,null,null,null);e["default"]=w.exports;p()(w,{VAlert:_["a"],VBtn:v["a"],VCol:f["a"],VContainer:b["a"],VRow:k["a"],VTextField:x["a"]})},c289:function(t,e,i){"use strict";var a=i("e422"),s=i.n(a);s.a},e422:function(t,e,i){}}]);
//# sourceMappingURL=about~b1bc70ec.3a65f3e5.js.map