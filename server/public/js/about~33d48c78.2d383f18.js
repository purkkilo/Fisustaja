(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about~33d48c78"],{"09e0":function(t,e,i){},"2b56":function(t,e,i){"use strict";var a=i("09e0"),s=i.n(a);s.a},3530:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("Header",{staticStyle:{"margin-bottom":"100px"}}),i("v-tabs",{attrs:{"background-color":"blue lighten-2",color:"blue darken-4",grow:"","show-arrows":"","next-icon":"mdi-arrow-right-bold-box-outline","prev-icon":"mdi-arrow-left-bold-box-outline","center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tabs-slider",{attrs:{color:"blue darken-4"}}),i("v-tab",{attrs:{href:"#overview"}},[t._v("Yleisnäkymä")]),i("v-tab",{attrs:{href:"#users"}},[t._v("Käyttäjät")]),i("v-tab",{attrs:{href:"#competitions"}},[t._v("Kilpailut")]),i("v-tab",{attrs:{href:"#feedback"}},[t._v("Saatu palaute")]),i("v-tab",{attrs:{href:"#generate"}},[t._v("Kilpailun generointi")])],1),i("v-tabs-items",{staticStyle:{background:"rgba(0,0,0,0.4)"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"overview"}},[i("v-row",[i("v-col",[i("v-row",[t.prevRoute?i("v-col",[t.prevRoute.name?i("v-btn",{attrs:{large:"",rounded:"",color:"yellow"},on:{click:function(e){return t.$router.push({path:t.prevRoute.path})}}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Palaa takaisin")]):t._e()],1):t._e()],1),i("v-row",[i("v-col",[i("h1",[t._v("Yleistietoja")])])],1),t.loading?i("v-row",[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h3",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan palautteita... ")]),i("ProgressBarQuery")],1)],1):i("v-row",[i("v-col",{staticClass:"inputarea black--text",attrs:{md:"6","offset-md":"3"}},[t.feedback.length?i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("feedback")]),t._v(" Palautetta annettu: "+t._s(t.feedback.length)+" kpl ")]):i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("feedback")]),t._v(" Ei palautetta! ")])])],1),t.loading_users?i("v-row",[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h3",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan käyttäjiä... ")]),i("ProgressBarQuery")],1)],1):i("v-row",[i("v-col",{staticClass:"inputarea black--text",attrs:{md:"6","offset-md":"3"}},[t.users.length?i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("account_circle")]),t._v(" Käyttäjiä yhteensä: "+t._s(t.users.length)+" kpl ")]):i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("account_circle")]),t._v(" Ei käyttäjiä! ")])])],1),t.loading_competitions?i("v-row",[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h3",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan kilpailuja... ")]),i("ProgressBarQuery")],1)],1):i("v-row",[i("v-col",{staticClass:"inputarea black--text",attrs:{md:"6","offset-md":"3"}},[t.all_competitions.length?i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("directions_boat")]),t._v(" Kilpailuja yhteensä: "+t._s(t.all_competitions.length)+" kpl"),i("br"),t._v("---\x3e Itse luotuja "+t._s(t.competitions.length)+"/"+t._s(t.all_competitions.length)+" kpl ")]):i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("directions_boat")]),t._v(" Ei kilpailuja! ")])])],1),t.loading_cups?i("v-row",[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h3",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan Cuppeja... ")]),i("ProgressBarQuery")],1)],1):i("v-row",[i("v-col",{staticClass:"inputarea black--text",attrs:{md:"6","offset-md":"3"}},[t.all_cups.length?i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("directions_boat")]),t._v(" Cuppeja yhteensä: "+t._s(t.all_cups.length)+" kpl"),i("br"),t._v("---\x3e Itse luotuja "+t._s(t.cups.length)+"/"+t._s(t.all_cups.length)+" kpl ")]):i("p",{staticClass:"flow-text"},[i("i",{staticClass:"material-icons"},[t._v("directions_boat")]),t._v(" Ei cuppeja! ")])])],1)],1)],1)],1),i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"users"}},[i("v-row",[i("v-col",[i("v-row",[t.prevRoute?i("v-col",[t.prevRoute.name?i("v-btn",{attrs:{large:"",rounded:"",color:"yellow"},on:{click:function(e){return t.$router.push({path:t.prevRoute.path})}}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Palaa takaisin")]):t._e()],1):t._e()],1),i("v-row",[i("v-col",[i("h1",[t._v("Käyttäjät")]),i("br"),i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" *Klikkaa nimeä saadaksesi lisätietoa ")])])],1),t.users.length?i("v-row",[i("v-col",{class:{"grey darken-4":t.$store.getters.getTheme},attrs:{md:"6","offset-md":"3"}},[i("v-data-iterator",{staticClass:"scroll_table",attrs:{items:t.users,search:t.search,"hide-default-footer":""},scopedSlots:t._u([{key:"header",fn:function(){return[i("v-toolbar",{staticClass:"mb-1",attrs:{dark:t.$store.getters.getTheme}},[i("v-text-field",{attrs:{clearable:"",flat:"","solo-inverted":"","hide-details":"","prepend-inner-icon":"search",label:"Etsi"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(e){return t._l(e.items,(function(e,a){return i("v-col",{key:a,staticStyle:{"margin-top":"20px"}},[i("v-menu",{attrs:{bottom:"",right:"",transition:"scale-transition",origin:"top left","close-on-click":!1},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on;return[i("v-chip",t._g({attrs:{dark:t.$store.getters.getTheme,outlined:t.$store.getters.getTheme,large:"",color:e.is_admin?"yellow darken-2":"green"}},s),[i("v-avatar",{attrs:{left:""}},[e.is_admin?i("i",{staticClass:"material-icons"},[t._v("admin_panel_settings")]):i("i",{staticClass:"material-icons"},[t._v("account_circle")])]),t._v(" "+t._s(e.name)+" ")],1)]}}],null,!0),model:{value:e.menu,callback:function(i){t.$set(e,"menu",i)},expression:"user.menu"}},[i("v-card",{attrs:{width:"300"}},[i("v-list",{attrs:{dark:""}},[i("v-list-item",[i("v-list-item-avatar",[e.is_admin?i("i",{staticClass:"material-icons"},[t._v("admin_panel_settings")]):i("i",{staticClass:"material-icons"},[t._v("account_circle")])]),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e.name))]),i("v-list-item-subtitle",[t._v(t._s(e.email))])],1),i("v-list-item-action",[i("v-btn",{attrs:{icon:""},on:{click:function(t){e.menu=!1}}},[i("v-icon",[t._v("mdi-close-circle")])],1)],1)],1)],1),i("v-list",[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on,n=a.attrs;return[i("v-list-item",t._g(t._b({on:{click:function(i){return t.copyToClipboard(e._id,e)}}},"v-list-item",n,!1),s),[i("v-list-item-action",[i("v-icon",[t._v("mdi-badge-account-horizontal")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e._id))]),i("v-list-item-subtitle",[t._v("Id")])],1)],1)]}}],null,!0)},[i("span",[t._v("Kopioi")])]),i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on,n=a.attrs;return[i("v-list-item",t._g(t._b({on:{click:function(i){return t.copyToClipboard(e.createdAt,e)}}},"v-list-item",n,!1),s),[i("v-list-item-action",[i("v-icon",[t._v("mdi-calendar-check")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e.createdAt))]),i("v-list-item-subtitle",[t._v("Tili luotu")])],1)],1)]}}],null,!0)},[i("span",[t._v("Kopioi")])]),e.is_admin?i("v-list-item",{on:{click:function(){}}},[i("v-list-item-action",[i("v-icon",[t._v("mdi-briefcase")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Admin")]),i("v-list-item-subtitle",[t._v("Rooli")])],1)],1):i("v-list-item",{on:{click:function(){}}},[i("v-list-item-action",[i("v-icon",[t._v("mdi-briefcase")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Käyttäjä")]),i("v-list-item-subtitle",[t._v("Rooli")])],1)],1),i("v-list-item",{on:{click:function(){}}},[i("v-list-item-content",[i("v-btn",{attrs:{color:"blue"},on:{click:function(i){t.copyToClipboard(JSON.stringify(e),e)}}},[i("v-icon",[t._v("mdi-copy-content")]),t._v(" Kopio koko objekti ")],1)],1)],1)],1)],1)],1),i("v-divider",{staticStyle:{"margin-top":"10px"}})],1)}))}}],null,!1,3747817579)})],1)],1):t.loading_users?i("v-row",[i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("v-sheet",{staticClass:"px-3 pt-3 pb-3",attrs:{color:"grey "+(t.$store.getters.getTheme?"darken-2":"lighten-4")}},[i("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"card"}})],1)],1)],1):i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei käyttäjiä! ")])])],1)],1)],1)],1),i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"competitions"}},[i("v-row",[i("v-col",[i("v-row",[t.prevRoute?i("v-col",[t.prevRoute.name?i("v-btn",{attrs:{large:"",rounded:"",color:"yellow"},on:{click:function(e){return t.$router.push({path:t.prevRoute.path})}}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Palaa takaisin")]):t._e()],1):t._e()],1),i("v-row",[i("v-col",[i("h1",[t._v("Kilpailut")])])],1),t.all_competitions.length?i("v-row",[i("v-col",[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text"},[t._v("Kilpailut")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailua","single-line":"","hide-details":""},model:{value:t.search_comp,callback:function(e){t.search_comp=e},expression:"search_comp"}})],1),i("v-data-table",{attrs:{id:"normal-table",headers:t.headers,items:t.all_competitions,search:t.search_comp,loading:t.loading_competitions},scopedSlots:t._u([{key:"item.start_date",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:"primary darken-2"}},[t._v(t._s(a.start_date.format("DD.MM.YYYY")))])]}},{key:"item.cup_points_multiplier",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:t.getColor(a.cup_points_multiplier),outlined:t.$store.getters.getTheme}},[t._v(t._s(a.cup_points_multiplier)+"x")])]}},{key:"item.choose",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-btn",t._g(t._b({attrs:{color:"primary"},on:{click:function(e){return t.pickCompetition(a)}}},"v-btn",n,!1),s),[i("v-icon",{attrs:{color:"black"}},[t._v("mdi-arrow-right-bold-box-outline")])],1)]}}],null,!0)},[i("span",[t._v("Siirry kilpailuun")])])]}},{key:"item.delete",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-btn",t._g(t._b({attrs:{color:"red",loading:t.loading_competitions},on:{click:function(e){return t.deleteCompetition(a._id,!1)}}},"v-btn",n,!1),s),[i("v-icon",[t._v("mdi-delete-outline")])],1)]}}],null,!0)},[i("span",[t._v("Poista kilpailu")])])]}}],null,!0)})],1)],1)],1):i("v-row",[t.loading_competitions?i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("v-sheet",{staticClass:"px-3 pt-3 pb-3",attrs:{color:"grey "+(t.$store.getters.getTheme?"darken-2":"lighten-4")}},[i("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"card"}})],1)],1):i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei Kilpailuja! ")])])],1)],1)],1)],1),i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"feedback"}},[i("v-row",[i("v-col",[i("v-row",[t.prevRoute?i("v-col",[t.prevRoute.name?i("v-btn",{attrs:{large:"",rounded:"",color:"yellow"},on:{click:function(e){return t.$router.push({path:t.prevRoute.path})}}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Palaa takaisin")]):t._e()],1):t._e()],1),i("v-row",[i("v-col",[i("h1",[t._v("Saatu Palaute")])])],1),t.feedback.length?i("v-row",[i("v-col",[i("ul",{attrs:{id:"fish_weights"}},t._l(t.feedback,(function(e,a){return i("li",{key:a},[i("v-card",{staticClass:"mx-auto",staticStyle:{"margin-bottom":"30px","margin-top":"30px"},attrs:{dark:t.$store.getters.getTheme,"min-width":"200px","max-width":"850px"}},[i("v-card-title",[i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("span",{staticClass:"title font-weight-light"},[t._v("#"+t._s(a+1)+" "+t._s(e.type))])])],1),i("v-card-text",{staticClass:"headline font-weight-bold",staticStyle:{"word-break":"break-all"}},[t._v(" "+t._s(e.message)+" ")]),i("v-card-actions",[i("v-col",[i("v-btn",{staticClass:"black--text",attrs:{large:"",rounded:"",color:"yellow",loading:t.loading},on:{click:function(i){return t.deleteFeedback(e._id)}}},[i("i",{staticClass:"material-icons left"},[t._v("done_outline")]),t._v("Ratkaise")])],1)],1)],1)],1)})),0)])],1):i("v-row",[t.loading?i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("v-sheet",{staticClass:"px-3 pt-3 pb-3",attrs:{color:"grey "+(t.$store.getters.getTheme?"darken-2":"lighten-4")}},[i("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"card"}})],1)],1):i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Palautetta ei vielä annettu! ")])])],1)],1)],1)],1),i("v-tab-item",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{value:"generate"}},[i("v-row",[i("v-col",[i("v-row",[t.prevRoute?i("v-col",[t.prevRoute.name?i("v-btn",{attrs:{large:"",rounded:"",color:"yellow"},on:{click:function(e){return t.$router.push({path:t.prevRoute.path})}}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Palaa takaisin")]):t._e()],1):t._e()],1),i("v-row",[i("v-col",[i("h1",[t._v("Kilpailun generointi")])])],1),t.cup.name?i("v-row",[i("v-col",{attrs:{md:"3"}},[i("p",{staticClass:"center-align flow-text black--text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Valitse Cup ")])]),i("v-col",{staticClass:"d-flex",attrs:{md:"6"}},[i("v-select",{attrs:{"menu-props":t.$store.getters.getTheme?"dark":"light",dark:t.$store.getters.getTheme,items:t.cups,"item-text":"select","item-value":"_id",hint:t.cup.name+" ("+t.cup.year+")",disabled:!t.cup.name,outlined:"","return-object":"","single-line":"",loading:t.loading_cups},model:{value:t.cup,callback:function(e){t.cup=e},expression:"cup"}})],1),i("v-col",{attrs:{md:"3"}},[i("router-link",{attrs:{to:"/continue"}},[i("v-btn",{attrs:{tile:"",color:"green lighten-1"}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Luo uusi cup!")])],1)],1)],1):t._e(),t.cup.name?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Kilpailijoiden määrä","append-outer-icon":"add",maxlength:"6","prepend-icon":"remove",counter:6,rules:t.number_rules,disabled:!t.cup.name},on:{"click:append-outer":function(e){t.signees_amount>=0?t.signees_amount++:t.signees_amount=1},"click:prepend":function(e){t.signees_amount>=1?t.signees_amount--:t.signees_amount=0},paste:function(t){t.preventDefault()},keypress:function(e){return t.isNumber(e,!0)}},model:{value:t.signees_amount,callback:function(e){t.signees_amount=e},expression:"signees_amount"}})],1)],1):t._e(),t.cup.name?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-col",[i("span",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v("Onko Tiimikilpailua?")])]),i("v-col",{attrs:{"offset-md":"4"}},[i("v-radio-group",{attrs:{row:"",disabled:!t.cup.name},model:{value:t.team_competition,callback:function(e){t.team_competition=e},expression:"team_competition"}},[i("v-radio",{attrs:{label:"Kyllä",value:"Kyllä"}}),i("v-radio",{attrs:{label:"Ei",value:"Ei"}})],1)],1)],1)],1):i("v-row",[i("v-col",{attrs:{md:"6","offset-md":"3"}},[i("h3",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan Cuppeja... ")]),i("ProgressBarQuery")],1)],1),i("v-row",[i("v-col",[i("v-btn",{attrs:{large:"",rounded:"",color:"green",loading:t.loading_cups},on:{click:t.generateCompetition}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Generoi kilpailu")])],1)],1)],1)],1)],1)],1)],1)},s=[],n=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("a434"),i("b0c0"),i("159b"),i("96cf"),i("1da1")),o=i("4d5c"),r=i.n(o),l=i("8ef5"),c=i("7149"),u=i("3faa"),p=i("51dd"),m=i("a822"),d=i("96c7"),v={data:function(){return{tab:null,feedback:[],users:[],all_competitions:[],competitions:[],user_id:null,loading:!1,loading_users:!1,loading_competitions:!1,loading_cups:!1,all_cups:[],cups:[],cup:{},signees_amount:30,team_competition:"Ei",number_rules:[function(t){return!!t||"Kenttä ei voi jäädä tyhjäksi!"},function(t){return!isNaN(t||"")||"Ei ole numero!"},function(t){return(t||"")>=0||"Numeron pitää olla positiivinen!"}],headers:[{text:"Kilpailun Päivämäärä",value:"start_date"},{text:"Nimi",value:"name"},{text:"Käyttäjä",value:"username"},{text:"Cup",value:"cup_name"},{text:"Pistekerroin",value:"cup_points_multiplier"},{text:"Valitse",value:"choose",sortable:!1},{text:"Poista",value:"delete",sortable:!1}],search_comp:"",search:"",prevRoute:null}},beforeRouteEnter:function(t,e,i){i((function(t){t.prevRoute=e}))},components:{ProgressBarQuery:m["default"],Header:d["default"]},mounted:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.a.AutoInit(),t.checkLogin(),location.href="#",location.href="#app",t.loading=t.loading_users=t.loading_competitions=t.loading_cups=!0,i=JSON.parse(localStorage.getItem("user")),i&&(t.user_id=i["id"]),e.prev=7,e.next=10,l["a"].getFeedback();case 10:return t.feedback=e.sent,t.loading=!1,e.next=14,u["a"].getUsers();case 14:return t.users=e.sent,t.users.forEach((function(t){t.menu=!1})),t.loading_users=!1,e.next=19,c["a"].getCompetitions();case 19:t.all_competitions=e.sent,t.all_competitions.forEach((function(e){e.username=t.users.find((function(t){return t._id===e.user_id})).name,e.start_date=t.$moment(e.start_date),e.end_date=t.$moment(e.end_date),e.cup_name="".concat(e.cup_name," (").concat(e.start_date.format("YYYY"),")")})),t.all_competitions.sort((function(t,e){return e.start_date.isAfter(t.start_date)})),t.getCups(),t.loading_competitions=!1,e.next=29;break;case 26:e.prev=26,e.t0=e["catch"](7),console.error(e.t0.message);case 29:case"end":return e.stop()}}),e,null,[[7,26]])})))()},methods:{getColor:function(t){return t>1?"red":1===t?"green":"grey"},generateCompetition:function(){var t=JSON.parse(localStorage.getItem("user")),e=t["id"];r.a.toast({html:"TODO: Generoi kilpailu!"}),console.log("TODO: Generoi kilpailu!");var i={user_id:e,cup_id:this.cup.id,team_competition:"Ei"!==this.team_competition};console.log("Kilpailu olio:",i)},fallbackCopyToClipboard:function(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var i=document.execCommand("copy"),a=i?"successful":"unsuccessful";console.log("Fallback: text to copy: "+a)}catch(s){console.error("Fallback: unable to copy:",s)}document.body.removeChild(e)},copyToClipboard:function(t,e){navigator.clipboard?(navigator.clipboard.writeText(t).then((function(){r.a.toast({html:'"'.concat(t,'" kopioitu leikepöydälle')})}),(function(t){console.error("Async: Could not copy text: ",t),r.a.toast({html:"Kopiointi ei onnistunut jostain syystä..."})})),e.menu=!1):this.fallbackCopyToClipboard(t)},getCups:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.user_id){e.next=14;break}return t.loading_cups=!0,e.prev=2,e.next=5,p["a"].getCups();case 5:t.all_cups=e.sent,t.all_cups.length&&(t.all_cups.sort((function(t,e){return t.name-e.name})),t.all_cups.forEach((function(t){t.select="".concat(t.name," (").concat(t.year,")")})),t.cups=t.all_cups.filter((function(e){return e.user_id===t.user_id})),t.cup=t.cups[t.cups.length-1]),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),t.error=e.t0.message;case 12:e.next=15;break;case 14:console.error("No user found in localstorage!");case 15:t.loading_cups=!1;case 16:case"end":return e.stop()}}),e,null,[[2,9]])})))()},deleteFeedback:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.loading=!0,i.prev=1,i.next=4,l["a"].deleteFeedback(t);case 4:return r.a.toast({html:"Palaute ratkaistu!"}),i.next=7,l["a"].getFeedback();case 7:e.feedback=i.sent,e.loading=!1,i.next=14;break;case 11:i.prev=11,i.t0=i["catch"](1),console.error(i.t0.message);case 14:case"end":return i.stop()}}),i,null,[[1,11]])})))()},pickCompetition:function(t){this.$store.state.competition=t,localStorage.setItem("competition",JSON.stringify({id:t._id,start_date:t.start_date,end_date:t.end_date})),this.$router.push({path:"/overview"})},deleteCompetition:function(t,e){var i=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e){a.next=16;break}return r.a.toast({html:"Poistetaan tietokannasta!"}),i.loading_competitions=!0,a.prev=3,a.next=6,c["a"].deleteCompetition(t);case 6:s=i.all_competitions.findIndex((function(e){return e._id===t})),s>-1&&i.all_competitions.splice(s,1),i.loading_competitions=!1,a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](3),console.error(a.t0.message);case 14:a.next=17;break;case 16:i.$confirm("Oletko varma?","Poista kilpailu","question").then((function(e){e&&i.deleteCompetition(t,e)})).catch((function(t){t&&console.error(t)}));case 17:case"end":return a.stop()}}),a,null,[[3,11]])})))()},checkLogin:function(){var t=JSON.parse(localStorage.getItem("user")),e=localStorage.getItem("jwt");null!=t&&null!=e?(this.$store.state.logged_in=!0,1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1):(t&&localStorage.removeItem("user"),e&&localStorage.removeItem("jwt"),this.$store.state.logged_in=!1,this.$store.state.is_admin=!1,r.a.toast({html:"Tapahtui virhe... Kirjaudu sisään uudestaan"}))}}},_=v,h=(i("c895"),i("2877")),g=i("6544"),f=i.n(g),b=i("8212"),k=i("8336"),w=i("b0af"),x=i("99d9"),y=i("cc20"),C=i("62ad"),$=i("a523"),T=i("c377"),S=i("8fea"),V=i("ce7e"),j=i("132d"),P=i("8860"),I=i("da13"),K=i("1800"),R=i("8270"),E=i("5d23"),O=i("e449"),Y=i("67b6"),D=i("43a6"),F=i("0fd9"),L=i("b974"),N=i("8dd9"),A=i("3129"),M=i("2fa4"),H=i("71a3"),B=i("c671"),z=i("fe57"),J=i("aac8"),Q=i("9a96"),q=i("8654"),G=i("71d9"),U=i("3a2f"),W=Object(h["a"])(_,a,s,!1,null,"c6cf98f8",null);e["default"]=W.exports;f()(W,{VAvatar:b["a"],VBtn:k["a"],VCard:w["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VChip:y["a"],VCol:C["a"],VContainer:$["a"],VDataIterator:T["a"],VDataTable:S["a"],VDivider:V["a"],VIcon:j["a"],VList:P["a"],VListItem:I["a"],VListItemAction:K["a"],VListItemAvatar:R["a"],VListItemContent:E["a"],VListItemSubtitle:E["b"],VListItemTitle:E["c"],VMenu:O["a"],VRadio:Y["a"],VRadioGroup:D["a"],VRow:F["a"],VSelect:L["a"],VSheet:N["a"],VSkeletonLoader:A["a"],VSpacer:M["a"],VTab:H["a"],VTabItem:B["a"],VTabs:z["a"],VTabsItems:J["a"],VTabsSlider:Q["a"],VTextField:q["a"],VToolbar:G["a"],VTooltip:U["a"]})},"3bb8":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("Header"),t.errors.length?i("div",{attrs:{id:"errordiv"}},[i("ul",{staticClass:"collection with-header",staticStyle:{border:"1px solid red"}},[i("li",{staticClass:"collection-header",staticStyle:{background:"rgba(0,0,0,0)"}},[i("v-alert",{attrs:{type:"error"}},[t._v(" Korjaa seuraavat virheet: ")])],1),t._l(t.errors,(function(e,a){return i("li",{key:a,staticClass:"collection-item",attrs:{id:"error"}},[i("p",{staticClass:"flow-text"},[t._v(t._s(a+1)+". "+t._s(e))])])}))],2)]):t._e(),i("v-tabs",{attrs:{"background-color":"blue lighten-2",color:"blue darken-4",grow:"","show-arrows":"","next-icon":"mdi-arrow-right-bold-box-outline","prev-icon":"mdi-arrow-left-bold-box-outline","center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tabs-slider",{attrs:{color:"blue darken-4"}}),i("v-tab",{attrs:{href:"#competitions"}},[t._v("Kaikki kilpailut")]),i("v-tab",{attrs:{href:"#create"}},[t._v("Luo Cup")]),i("v-tab",{attrs:{href:"#cups"}},[t._v("Cupit")])],1),i("v-tabs-items",{staticStyle:{background:"rgba(0,0,0,0.6)"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tab-item",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},attrs:{value:"competitions"}},[i("v-row",[i("v-col",[i("h1",[t._v("Kilpailut")])])],1),i("v-row",[i("v-col",[t.competitions.length?i("div",{staticClass:"scroll_table"},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text"},[t._v("Kilpailut")]),i("v-spacer"),i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,"append-icon":"mdi-magnify",label:"Hae kilpailua","single-line":"","hide-details":""},model:{value:t.search_comp,callback:function(e){t.search_comp=e},expression:"search_comp"}})],1),i("v-data-table",{attrs:{id:"normal-table",headers:t.headers,items:t.competitions,search:t.search_comp},scopedSlots:t._u([{key:"item.start_date",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:"primary darken-2"}},[t._v(t._s(a.start_date.format("DD.MM.YYYY")))])]}},{key:"item.cup_name",fn:function(e){var a=e.item;return[i("v-chip",[t._v(t._s(a.cup_name)+" ("+t._s(a.start_date.format("YYYY"))+")")])]}},{key:"item.cup_points_multiplier",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:t.getColor(a.cup_points_multiplier),outlined:t.$store.getters.getTheme}},[t._v(t._s(a.cup_points_multiplier)+"x")])]}},{key:"item.choose",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-btn",t._g(t._b({attrs:{color:"primary"},on:{click:function(e){return t.pickCompetition(a)}}},"v-btn",n,!1),s),[i("v-icon",{attrs:{color:"black"}},[t._v("mdi-arrow-right-bold-box-outline")])],1)]}}],null,!0)},[i("span",[t._v("Siirry kilpailuun")])])]}}],null,!0)})],1)],1):i("div",[t.loading?t.error?i("v-col",[i("h2",{staticClass:"error"},[t._v(t._s(t.error))])]):i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan kilpailuja... ")]),i("ProgressBarQuery")],1):i("v-col",[i("v-row",[t.cups.length?i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei kilpailuja! ")]),i("router-link",{attrs:{to:"/register-comp"}},[i("v-btn",{attrs:{tile:"",color:"blue lighten-1"}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Luo kilpailu!")])],1)],1):i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei kilpailuja! ")]),i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Luo Cup ensin ")]),i("v-btn",{attrs:{tile:"",color:"blue lighten-1"},on:{click:function(e){t.tab="create"}}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Luo Cup!")])],1)],1)],1)],1),t.competitions.length?i("v-col",{staticStyle:{"margin-top":"20px"}},[i("router-link",{attrs:{to:"/register-comp"}},[i("v-btn",{attrs:{tile:"",color:"blue lighten-1"}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Luo uusi kilpailu!")])],1)],1):t._e()],1)],1)],1),i("v-tab-item",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},attrs:{value:"create"}},[i("v-row",[i("v-col",[i("h1",[t._v("Luo Cup")])])],1),i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"8","offset-md":"2"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Cupin nimi",maxlength:40,loading:t.loading,counter:40},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,s=e.attrs;return[i("v-text-field",t._g(t._b({attrs:{dark:t.$store.getters.getTheme,label:"Vuosi","prepend-icon":"event",readonly:""},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}},"v-text-field",s,!1),a))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[i("v-date-picker",{ref:"picker",attrs:{min:"2000-01-01",reactive:"","no-title":""},on:{input:t.saveYear},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}})],1)],1)],1),i("v-row",[i("v-col",[i("v-btn",{attrs:{tile:"",color:"primary",loading:t.loading},on:{click:t.saveCup}},[i("i",{staticClass:"material-icons left"},[t._v("check")]),t._v("Luo Cup")])],1)],1)],1),i("v-tab-item",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},attrs:{value:"cups"}},[i("v-row",[i("v-col",[i("h1",[t._v("Cupit")])])],1),i("v-row",[i("v-col",[t.cups.length?i("div",{staticClass:"scroll_table"},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text"},[t._v("Cupit")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae cuppia","single-line":"","hide-details":""},model:{value:t.search_cup,callback:function(e){t.search_cup=e},expression:"search_cup"}})],1),i("v-data-table",{attrs:{id:"normal-table",headers:t.headers_cup,items:t.cups,search:t.search_cup,loading:t.publishing},scopedSlots:t._u([{key:"item.name",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:"primary darken-3"}},[t._v(t._s(a.name))])]}},{key:"item.year",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:"grey",outlined:t.$store.getters.getTheme}},[t._v(t._s(a.year))])]}},{key:"item.isPublic",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-chip",t._g(t._b({attrs:{outlined:t.$store.getters.getTheme,color:a.isPublic?"green darken-2":"red darken-2",disabled:t.publishing},on:{click:function(e){return t.publishCup(a)}}},"v-chip",n,!1),s),[t._v(t._s(a.isPublic?"Julkinen":"Salainen"))])]}}],null,!0)},[i("span",[t._v("Muuta tila painamalla")])])]}},{key:"item.choose",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-btn",t._g(t._b({attrs:{color:"primary"},on:{click:function(e){return t.pickCup(a)}}},"v-btn",n,!1),s),[i("v-icon",{attrs:{color:"black"}},[t._v("mdi-arrow-right-bold-box-outline")])],1)]}}],null,!0)},[i("span",[t._v("Siirry Cuppiin")])])]}}],null,!0)})],1)],1):i("v-row",[t.loading?t.error?i("v-col",{staticClass:"error"},[i("h2",[t._v(t._s(t.error))])]):i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan Cuppeja... ")]),i("ProgressBarQuery")],1):i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei Cuppeja! ")]),i("v-btn",{attrs:{tile:"",color:"blue lighten-1"},on:{click:function(e){t.tab="create"}}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Luo Cup!")])],1)],1)],1)],1)],1)],1)],1)},s=[],n=(i("4160"),i("b0c0"),i("ac1f"),i("1276"),i("159b"),i("96cf"),i("1da1")),o=i("96c7"),r=i("a822"),l=i("7149"),c=i("51dd"),u=i("4d5c"),p=i.n(u),m={name:"ContinueComp",data:function(){return{tab:null,competitions:[],headers:[{text:"Kilpailun Päivämäärä",value:"start_date"},{text:"Nimi",value:"name"},{text:"Cup",value:"cup_name"},{text:"Pistekerroin",value:"cup_points_multiplier"},{text:"Valitse",value:"choose",sortable:!1}],headers_cup:[{text:"Nimi",value:"name"},{text:"Vuosi",value:"year"},{text:"Julkisuus",value:"isPublic"},{text:"Valitse",value:"choose",sortable:!1}],error:"",competition_input:null,loading:!1,publishing:!1,cups:[],name:null,year:null,menu:!1,errors:[],search_comp:"",search_cup:""}},watch:{menu:function(t){var e=this;t&&this.$nextTick((function(){return e.$refs.picker.activePicker="YEAR"}))}},components:{ProgressBarQuery:r["default"],Header:o["default"]},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var i,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,i=JSON.parse(localStorage.getItem("user")),a=i["id"],s={user_id:a},e.next=6,l["a"].getCompetitions(s).then((function(e){t.competitions=e,t.competitions.forEach((function(e){e.start_date=t.$moment(e.start_date),e.end_date=t.$moment(e.end_date)})),t.competitions.sort((function(t,e){return e.start_date.isAfter(t.start_date)}))})).catch((function(e){return e.response?(e.response.status,t.loading=!1,console.log(e)):console.log(e)}));case 6:return e.next=8,c["a"].getCups({user_id:a}).then((function(e){t.cups=e,t.cups.sort((function(e,i){return t.$moment(i.year).isAfter(t.$moment(e.year))}))})).catch((function(e){return e.response?400===e.response.status?(console.log(e),t.showError("Bad request!")):408===e.response.status?t.showError("Yhteyttä tietokantaan ei saatu... Yritä uudelleen päivittämällä sivu (Connection timed out)"):console.log(e):console.log(e)}));case 8:t.loading=!1;case 9:case"end":return e.stop()}}),e)})))()},mounted:function(){this.$route.query.tab&&(this.tab=this.$route.query.tab),p.a.AutoInit(),this.checkLogin(),location.href="#",location.href="#app"},methods:{getColor:function(t){return t>1?"red":1===t?"green":"grey"},publishCup:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.isPublic=!t.isPublic,i.prev=1,e.publishing=!0,a={$set:{isPublic:t.isPublic}},i.next=6,c["a"].updateValues(t.id,a);case 6:i.next=11;break;case 8:i.prev=8,i.t0=i["catch"](1),console.error(i.t0.message);case 11:e.publishing=!1;case 12:case"end":return i.stop()}}),i,null,[[1,8]])})))()},showError:function(t){this.errors.push(t),p.a.toast({html:t}),location.href="#",location.href="#app"},checkLogin:function(){var t=JSON.parse(localStorage.getItem("user")),e=localStorage.getItem("jwt");null!=t&&null!=e?(this.$store.state.logged_in=!0,1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1):(t&&localStorage.removeItem("user"),e&&localStorage.removeItem("jwt"),this.$store.state.logged_in=!1,this.$store.state.is_admin=!1,p.a.toast({html:"Tapahtui virhe... Kirjaudu sisään uudestaan"}))},pickCompetition:function(t){this.$store.state.competition=t,localStorage.setItem("competition",JSON.stringify({id:t._id,start_date:t.start_date,end_date:t.end_date})),this.$router.push({path:"/overview"})},pickCup:function(t){localStorage.setItem("cup",t.id),this.$router.push({path:"/cup-overview"})},saveYear:function(t){t=t.split("-")[0],this.year=t,this.$refs.picker.activePicker="YEAR",this.menu=!1},saveCup:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var i,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.errors=[],t.loading=!0,t.name||t.showError("Syötä Cupille nimi!"),t.year||t.showError("Valitse Cupille vuosi!"),t.errors.length){e.next=24;break}return i=JSON.parse(localStorage.getItem("user")),a=i["id"],s={user_id:a,name:t.name,year:t.year},e.prev=8,e.next=11,c["a"].insertCup(s);case 11:return p.a.toast({html:"Cup lisätty tietokantaan!"}),e.next=14,c["a"].getCups({user_id:a});case 14:t.cups=e.sent,t.loading=!1,t.year=null,t.name=null,t.tab="cups",e.next=24;break;case 21:e.prev=21,e.t0=e["catch"](8),t.errors.push(e.t0.message);case 24:t.loading=!1;case 25:case"end":return e.stop()}}),e,null,[[8,21]])})))()}}},d=m,v=i("2877"),_=i("6544"),h=i.n(_),g=i("0798"),f=i("8336"),b=i("b0af"),k=i("99d9"),w=i("cc20"),x=i("62ad"),y=i("a523"),C=i("8fea"),$=i("2e4b"),T=i("132d"),S=i("e449"),V=i("0fd9"),j=i("2fa4"),P=i("71a3"),I=i("c671"),K=i("fe57"),R=i("aac8"),E=i("9a96"),O=i("8654"),Y=i("3a2f"),D=Object(v["a"])(d,a,s,!1,null,null,null);e["default"]=D.exports;h()(D,{VAlert:g["a"],VBtn:f["a"],VCard:b["a"],VCardTitle:k["c"],VChip:w["a"],VCol:x["a"],VContainer:y["a"],VDataTable:C["a"],VDatePicker:$["a"],VIcon:T["a"],VMenu:S["a"],VRow:V["a"],VSpacer:j["a"],VTab:P["a"],VTabItem:I["a"],VTabs:K["a"],VTabsItems:R["a"],VTabsSlider:E["a"],VTextField:O["a"],VTooltip:Y["a"]})},"6e7a":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("Header"),i("v-row",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme}},[i("v-col",[t.error?i("v-row",[t._v(" "+t._s(t.error)+" ")]):t._e(),i("div",{staticClass:"section",attrs:{id:"send-feedback"}},[i("v-row",[t.prevRoute?i("v-col",[t.prevRoute.name?i("v-btn",{attrs:{large:"",rounded:"",color:"yellow"},on:{click:function(e){return t.$router.push({path:t.prevRoute.path})}}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Palaa takaisin")]):t._e()],1):t._e()],1),i("h1",[t._v("Lähetä palautetta")]),i("p",{staticClass:"flow-text title black-text"},[t._v(" Ilmoita bugeista, kehitysehdotuksista jne jne. ")]),i("v-row",[i("v-col",{staticClass:"d-flex",attrs:{md:"4","offset-md":"4"}},[i("v-select",{attrs:{"menu-props":t.$store.getters.getTheme?"dark":"light",dark:t.$store.getters.getTheme,"item-color":"blue",items:t.type_options,label:"Palautteen tyyppi",outlined:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1)],1),i("v-row",[i("v-col",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{md:"8","offset-md":"2"}},[i("v-textarea",{attrs:{dark:t.$store.getters.getTheme,name:"input-7-1",filled:"",label:"Palaute tähän","auto-grow":"",value:t.message,maxlength:"800"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1),i("v-row",[i("v-col",{attrs:{md:"4","offset-md":"4"}},[i("v-btn",{attrs:{block:"",color:"grey darken-2",loading:t.loading},on:{click:t.sendFeedback}},[i("i",{staticClass:"material-icons left"},[t._v("note_add")]),t._v("Lähetä palaute")])],1)],1)],1)],1)],1)],1)},s=[],n=(i("96cf"),i("1da1")),o=i("4d5c"),r=i.n(o),l=i("8ef5"),c=i("96c7"),u={name:"Feedback",components:{Header:c["default"]},data:function(){return{prevRoute:null,message:null,type:null,type_options:["Bugi","Ehdotus","Muu"],loading:!1,error:null}},beforeRouteEnter:function(t,e,i){i((function(t){t.prevRoute=e}))},mounted:function(){r.a.AutoInit(),this.type=this.type_options[0],this.checkLogin(),location.href="#",location.href="#app"},methods:{sendFeedback:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.type||(t.type="-"),!t.message){e.next=21;break}if(!(t.message.length>=5)){e.next=18;break}return i={type:t.type,message:t.message},t.loading=!0,e.prev=5,e.next=8,l["a"].insertFeedback(i);case 8:r.a.toast({html:"Palaute vastaanotettu!"}),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](5),console.error(e.t0.message);case 14:t.loading=!1,t.message=null,e.next=19;break;case 18:r.a.toast({html:"Kirjoita vähintään 5 merkkiä pitkä palaute!"});case 19:e.next=22;break;case 21:r.a.toast({html:"Kirjoita vähintään 5 merkkiä pitkä palaute!"});case 22:case"end":return e.stop()}}),e,null,[[5,11]])})))()},checkLogin:function(){var t=JSON.parse(localStorage.getItem("user")),e=localStorage.getItem("jwt");null!=t&&null!=e?(this.$store.state.logged_in=!0,1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1):(t&&localStorage.removeItem("user"),e&&localStorage.removeItem("jwt"),this.$store.state.logged_in=!1,this.$store.state.is_admin=!1)}}},p=u,m=i("2877"),d=i("6544"),v=i.n(d),_=i("8336"),h=i("62ad"),g=i("a523"),f=i("0fd9"),b=i("b974"),k=i("a844"),w=Object(m["a"])(p,a,s,!1,null,null,null);e["default"]=w.exports;v()(w,{VBtn:_["a"],VCol:h["a"],VContainer:g["a"],VRow:f["a"],VSelect:b["a"],VTextarea:k["a"]})},7277:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("Header"),i("v-row",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme}},[i("v-col",[i("v-row",[i("v-col",[i("h1",[t._v("Dashboard")])])],1),i("v-row",[i("v-col",[t.user?i("div",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[i("b",[t._v(t._s(t.user.name))])]),i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[i("b",[t._v(t._s(t.user.email))])]),i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[i("b",[t._v("Tili luotu: "+t._s(t.created))])])]):t._e(),i("div",{staticClass:"divider black"}),i("div",{staticClass:"section"},[i("v-row",[i("v-col",{staticStyle:{"margin-top":"20px"},attrs:{md:"6"}},[i("router-link",{attrs:{to:"/register-comp"}},[i("v-btn",{attrs:{large:"",tile:"",color:"blue lighten-1"}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Uusi kilpailu")])],1)],1),i("v-col",{staticStyle:{"margin-top":"20px"},attrs:{md:"6"}},[i("router-link",{attrs:{to:"/continue"}},[i("v-btn",{attrs:{large:"",tile:"",color:"green lighten-1"}},[i("i",{staticClass:"material-icons left"},[t._v("play_circle_filled")]),t._v("Jatka kilpailua")])],1)],1)],1)],1)])],1)],1)],1)],1)},s=[],n=(i("99af"),i("96c7")),o={name:"Home",components:{Header:n["default"]},data:function(){return{user:null,created:null}},mounted:function(){if(this.$store.commit("refreshCompetition",null),localStorage.removeItem("competition"),this.$store.commit("refreshCup",null),localStorage.removeItem("cup"),this.checkLogin(),null!=localStorage.getItem("user")){this.user=JSON.parse(localStorage.getItem("user"));var t=this.$moment(this.user.createdAt);this.created="".concat(t.date(),".").concat(t.month()+1,".").concat(t.year())}location.href="#",location.href="#app"},methods:{checkLogin:function(){var t=JSON.parse(localStorage.getItem("user")),e=localStorage.getItem("jwt");null!=t&&null!=e?(this.$store.state.logged_in=!0,1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1):(t&&localStorage.removeItem("user"),e&&localStorage.removeItem("jwt"),this.$store.state.logged_in=!1,this.$store.state.is_admin=!1)}}},r=o,l=(i("2b56"),i("2877")),c=i("6544"),u=i.n(c),p=i("8336"),m=i("62ad"),d=i("a523"),v=i("0fd9"),_=Object(l["a"])(r,a,s,!1,null,null,null);e["default"]=_.exports;u()(_,{VBtn:p["a"],VCol:m["a"],VContainer:d["a"],VRow:v["a"]})},9984:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Header",{staticStyle:{"margin-bottom":"60px"}}),i("v-navigation-drawer",{attrs:{permanent:""}},[i("v-card",{staticClass:"mx-auto",attrs:{"max-width":"400",tile:"",dark:t.$store.getters.getTheme}},[i("v-list",{attrs:{dense:""}},[i("p",[t._v("Navigointi")]),i("v-list-item-group",{attrs:{color:"primary"},model:{value:t.selectedItem,callback:function(e){t.selectedItem=e},expression:"selectedItem"}},[i("v-divider"),t._l(t.items,(function(e,a){return i("div",{key:a},[i("v-list-item",{attrs:{disabled:t.$router.currentRoute.path===e.path},on:{click:function(i){return t.changePage(e.path)}}},[i("v-list-item-icon",[i("v-icon",{domProps:{textContent:t._s(e.icon)}})],1),i("v-list-item-content",[i("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)],1),i("v-divider")],1)}))],2)],1)],1)],1),i("v-container",[i("v-card",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},attrs:{dark:t.$store.getters.getTheme}},[i("v-row",[i("v-col",{attrs:{cols:"12",xs:"12",sm:"12",md:"12"}},[i("v-row",[i("v-col",{attrs:{md:"7"}},[i("h1",[t._v("Kilpailun määritykset")])]),i("v-col",{attrs:{md:"5"}},[i("div",{staticClass:"text-center"},[i("v-dialog",{scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,s=e.attrs;return[i("p",{class:{"black-text":!t.$store.getters.getTheme,"white-text":t.$store.getters.getTheme}},[t._v(" Kello/Kilpailuaika ")]),i("v-btn",t._g(t._b({attrs:{text:"",outlined:"",color:"red darken-4",dark:""}},"v-btn",s,!1),a),[i("v-icon",[t._v("mdi-timer")])],1)]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",{staticClass:"headline"}),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",outlined:""},on:{click:function(e){t.dialog=!1}}},[t._v(" Sulje ")])],1)],1)],1)],1)])],1)],1)],1)],1),i("v-tabs",{attrs:{"background-color":"blue lighten-2",color:"blue darken-4",grow:"","show-arrows":"","next-icon":"mdi-arrow-right-bold-box-outline","prev-icon":"mdi-arrow-left-bold-box-outline","center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tabs-slider",{attrs:{color:"blue darken-4"}}),i("v-tab",{attrs:{href:"#show-settings"}},[t._v("Määritykset")]),i("v-tab",{attrs:{href:"#change-settings",disabled:t.loading}},[t._v("Muuta määrityksiä")])],1),i("v-tabs-items",{staticStyle:{background:"rgba(0,0,0,0.4)"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tab-item",{attrs:{value:"show-settings"}},[t.loading?i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Haetaan määrityksiä... ")]),i("ProgressBarQuery")],1)],1):i("v-row",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},attrs:{id:"settings-info"}},[i("v-col",[i("v-row",{staticStyle:{"margin-top":"20px"}},[i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme,elevation:"20",outlined:""}},[i("v-card-title",{staticClass:"text-center"},[i("p",{staticClass:"display-1"},[t._v(" Perustiedot ")])]),i("v-list",{attrs:{outlined:"",elevation:"10"}},[i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-ferry")])],1),i("v-list-item-title",[t._v("Kilpailu")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.competition.name)+" ("+t._s(t.competition.locality)+")")])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"yellow darken-4"}},[t._v("mdi-trophy")])],1),i("v-list-item-title",[t._v("Cup")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.competition.cup_name))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-calendar-arrow-right")])],1),i("v-list-item-title",[t._v("Aloituspäivä")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.formatted_start_date))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-calendar-multiple-check")])],1),i("v-list-item-title",[t._v("Lopetuspäivä")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.formatted_end_date))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-calendar-clock")])],1),i("v-list-item-title",[t._v("Kilpailuaika")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(" "+t._s(t.competition.start_time)+" - "+t._s(t.competition.end_time))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"green"}},[t._v("mdi-format-list-numbered")])],1),i("v-list-item-title",[t._v("Voittajan Cup sijoittumispisteet")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.competition.cup_placement_points))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"green darken-2"}},[t._v("mdi-clipboard-check")])],1),i("v-list-item-title",[t._v("Kilpailijoiden Cup osallistumispisteet")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(t.competition.cup_participation_points))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"green darken-1"}},[t._v("mdi-calculator-variant-outline")])],1),i("v-list-item-title",[t._v("Kilpailun pistekerroin")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v("x "+t._s(t.competition.cup_points_multiplier))])])],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-incognito")])],1),i("v-list-item-title",[t._v("Onko kilpailu julkinen")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[t.competition.isPublic?i("v-icon",{attrs:{color:"green darken-2"}},[t._v("mdi-check-bold")]):i("v-icon",{attrs:{color:"red"}},[t._v("mdi-close")])],1)],1),i("v-divider"),i("v-list-item",[i("v-list-item-icon",[i("v-icon",{attrs:{color:"yellow darken-4"}},[t._v("mdi-trophy-award")])],1),i("v-list-item-title",[t._v("Onko kilpailu päättynyt")]),i("v-list-item-subtitle",{staticClass:"blue-text"},[t.competition.isFinished?i("v-icon",{attrs:{color:"green darken-2"}},[t._v("mdi-check-bold")]):i("v-icon",{attrs:{color:"red"}},[t._v("mdi-close")])],1)],1)],1)],1)],1)],1),i("v-row",{staticClass:"fishes_summary"},[i("v-col",{staticClass:"scroll_table",attrs:{md:"10","offset-md":"1"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme,elevation:"20",outlined:""}},[i("v-card-title",{staticClass:"text-center"},[i("p",{staticClass:"display-1"},[t._v(" Kalojen määritykset ")])]),i("v-list",{attrs:{outlined:"",elevation:"10"}},t._l(t.fish_specs,(function(e,a){return i("div",{key:a},[i("v-list-item",[i("v-list-item-title",[t._v(t._s(e.name))]),i("v-divider",{attrs:{vertical:""}}),i("v-list-item-subtitle",{staticClass:"green-text"},[i("b",[t._v(" x "+t._s(e.multiplier))])]),i("v-divider",{attrs:{vertical:""}}),i("v-list-item-subtitle",{staticClass:"blue-text"},[i("b",[t._v(t._s(e.minsize)+" cm")])])],1),i("v-divider")],1)})),0)],1)],1)],1),t.loading?t._e():i("v-row",[i("v-col",{staticStyle:{"margin-top":"20px"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",tile:"",color:t.competition.isPublic?"grey darken-4":"green darken-4",loading:t.updating},on:{click:function(e){return t.publishCompetition(t.competition.isPublic)}}},[t.competition.isPublic?i("div",[i("v-icon",[t._v("mdi-incognito")]),t._v(" Aseta kilpailu salaiseksi ")],1):i("div",[i("v-icon",{attrs:{color:"green"}},[t._v("mdi-publish")]),t._v(" Aseta kilpailu julkiseksi ")],1)])],1),i("v-col",{staticStyle:{"margin-top":"20px"}},[i("v-btn",{attrs:{large:"",tile:"",color:t.competition.isFinished?"yellow":"green darken-3",loading:t.updating},on:{click:function(e){return t.endCompetition(t.competition.isFinished)}}},[t.competition.isFinished?i("div",[i("v-icon",{attrs:{color:"red darken-2"}},[t._v("mdi-cancel")]),t._v(" Aseta kilpailu keskeneräiseksi ")],1):i("div",[i("v-icon",{attrs:{color:"yellow"}},[t._v("mdi-trophy")]),t._v(" Aseta kilpailu päättyneeksi ")],1)])],1)],1),i("v-row",[i("v-col",{staticStyle:{"margin-top":"20px"},attrs:{md:"3","offset-md":"4"}},[i("v-btn",{staticClass:"white--text",attrs:{block:"",color:"red darken-4",loading:t.updating},on:{click:function(e){return t.deleteCompetition(t.competition._id,!1)}}},[i("v-icon",{attrs:{color:"white"}},[t._v("mdi-delete-forever")]),t._v(" Poista Kilpailu")],1)],1)],1)],1)],1)],1),i("v-tab-item",{attrs:{value:"change-settings"}},[i("div",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme}},[t.errors.length?i("div",{attrs:{id:"errordiv"}},[i("ul",{staticClass:"collection with-header",staticStyle:{border:"1px solid red"}},[i("li",{staticClass:"collection-header",staticStyle:{background:"rgba(0,0,0,0)"}},[i("v-alert",{attrs:{type:"error"}},[t._v(" Korjaa seuraavat virheet: ")])],1),t._l(t.errors,(function(e,a){return i("li",{key:a,staticClass:"collection-item",attrs:{id:"error"}},[i("p",{staticClass:"flow-text"},[t._v(t._s(a+1)+". "+t._s(e))])])}))],2)]):t._e(),i("v-row",[i("v-col",[i("h1",[t._v("Muuta määrityksiä")])])],1),i("v-row",[i("v-col",[i("p",{staticClass:"center-align flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Kilpailun perustiedot ")]),t.basic_info_validated?i("p",{staticClass:"flow-text yellow lighten-1 center-align"},[t._v(' Tiedot lukittuna, paina "Muuta tietoja" jos haluat varmasti muokata tietoja ')]):t._e()])],1),t.loading?i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tietoja... ")]),i("ProgressBarQuery")],1)],1):i("v-row",[i("v-col",{attrs:{md:"12"}},[t.competition?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Kilpailun nimi",maxlength:t.max_input,disabled:t.basic_info_validated,rules:t.rules,counter:t.max_input},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1):t._e(),t.competition?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Paikkakunta",maxlength:t.max_input,disabled:t.basic_info_validated,rules:t.rules,counter:t.max_input},model:{value:t.locality,callback:function(e){t.locality=e},expression:"locality"}})],1)],1):t._e(),t.loading_cups?i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Haetaan cuppeja... ")]),i("ProgressBarQuery")],1)],1):t._e(),t.cups?t._e():i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Cuppeja ei löytynyt... ")])])],1),t.competition.cup_name?i("v-row",[i("v-col",{attrs:{md:"3"}},[i("p",{staticClass:"center-align flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Valitse Cup ")])]),i("v-col",{staticClass:"d-flex",attrs:{md:"6"}},[i("v-select",{attrs:{dark:t.$store.getters.getTheme,items:t.cups,"item-text":"select","item-value":"_id",hint:t.cup.name+" ("+t.cup.year+")",disabled:t.basic_info_validated,outlined:"","return-object":"","single-line":""},model:{value:t.cup,callback:function(e){t.cup=e},expression:"cup"}})],1)],1):i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Kilpailusta ei löytynyt cuppia... ")])])],1),t.competition?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Kilpailun voittajan cup sijoittumispisteet","append-outer-icon":"add",maxlength:"6","prepend-icon":"remove",counter:6,rules:t.number_rules,disabled:t.basic_info_validated},on:{"click:append-outer":function(e){t.cup_placement_points>=0?t.cup_placement_points++:t.cup_placement_points=1},"click:prepend":function(e){t.cup_placement_points>=1?t.cup_placement_points--:t.cup_placement_points=0},paste:function(t){t.preventDefault()},keypress:function(e){return t.isNumber(e,!0)}},model:{value:t.cup_placement_points,callback:function(e){t.cup_placement_points=e},expression:"cup_placement_points"}})],1)],1):t._e(),t.competition?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Kilpailun cup osallistumispisteet","append-outer-icon":"add",maxlength:"6","prepend-icon":"remove",counter:6,rules:t.number_rules,disabled:t.basic_info_validated},on:{"click:append-outer":function(e){t.cup_participation_points>=0?t.cup_participation_points++:t.cup_participation_points=1},"click:prepend":function(e){t.cup_participation_points>=1?t.cup_participation_points--:t.cup_participation_points=0},paste:function(t){t.preventDefault()},keypress:function(e){return t.isNumber(e,!0)}},model:{value:t.cup_participation_points,callback:function(e){t.cup_participation_points=e},expression:"cup_participation_points"}})],1)],1):t._e(),t.competition?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Cup pistekerroin","append-outer-icon":"add",maxlength:"3","prepend-icon":"remove",counter:3,rules:t.number_rules,disabled:t.basic_info_validated},on:{"click:append-outer":function(e){t.cup_points_multiplier>=1?t.cup_points_multiplier+=.5:t.cup_points_multiplier=1},"click:prepend":function(e){t.cup_points_multiplier>=1.5?t.cup_points_multiplier-=.5:t.cup_points_multiplier=1},paste:function(t){t.preventDefault()},keypress:function(e){return t.isNumber(e,!0)}},model:{value:t.cup_points_multiplier,callback:function(e){t.cup_points_multiplier=e},expression:"cup_points_multiplier"}})],1)],1):t._e(),t.competition?i("v-row",[i("v-col",{staticClass:"input-fields",attrs:{md:"6","offset-md":"3"}},[i("v-col",[i("span",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v("Onko Tiimikilpailua?")])]),i("v-col",{attrs:{"offset-md":"4"}},[i("v-radio-group",{attrs:{dark:t.$store.getters.getTheme,row:"",disabled:t.basic_info_validated},model:{value:t.team_competition,callback:function(e){t.team_competition=e},expression:"team_competition"}},[i("v-radio",{attrs:{label:"Kyllä",value:"Kyllä"}}),i("v-radio",{attrs:{label:"Ei",value:"Ei"}})],1)],1)],1)],1):t._e(),t.competition?i("v-row",[i("v-col",{attrs:{cols:"12",md:"5"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",[i("span",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v("Kilpailun Aloituspäivä")])])],1),i("v-row",{attrs:{align:"center"}},[i("v-date-picker",{staticClass:"mt-4",staticStyle:{height:"480px"},attrs:{dark:t.$store.getters.getTheme,"full-width":"",elevation:"15",locale:"fi",disabled:t.basic_info_validated},model:{value:t.start_date,callback:function(e){t.start_date=e},expression:"start_date"}})],1)],1),i("v-col",{staticStyle:{"margin-bottom":"50px"},attrs:{cols:"12",md:"5","offset-md":"2"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",[i("span",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v("Kilpailun Lopetuspäivä")])])],1),i("v-row",[i("v-date-picker",{staticClass:"mt-4",staticStyle:{height:"480px"},attrs:{dark:t.$store.getters.getTheme,"full-width":"",elevation:"15",locale:"fi",disabled:t.basic_info_validated},model:{value:t.end_date,callback:function(e){t.end_date=e},expression:"end_date"}})],1)],1)],1):t._e(),t.competition?i("v-row",[i("v-col",{attrs:{cols:"12",md:"5"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",[i("span",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v("Kilpailun alkamismisaika")])])],1),i("v-row",{attrs:{align:"center"}},[i("v-col",[i("v-time-picker",{attrs:{dark:t.$store.getters.getTheme,format:"24hr","full-width":"",scrollable:"",elevation:"15",disabled:t.basic_info_validated},model:{value:t.start_time,callback:function(e){t.start_time=e},expression:"start_time"}})],1)],1)],1),i("v-col",{attrs:{cols:"12",md:"5","offset-md":"1"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",{attrs:{md:"12","offset-md":"2"}},[i("span",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v("Kilpailun loppumisaika")])])],1),i("v-row",{attrs:{align:"center"}},[i("v-col",{attrs:{md:"12","offset-md":"2"}},[i("v-time-picker",{attrs:{dark:t.$store.getters.getTheme,format:"24hr","full-width":"",scrollable:"",elevation:"15",disabled:t.basic_info_validated},model:{value:t.end_time,callback:function(e){t.end_time=e},expression:"end_time"}})],1)],1)],1)],1):t._e(),i("v-row",{staticClass:"fishes_summary"},[i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("table",{staticClass:"highlight centered responsive-table table_header"},[i("thead",[i("tr",[i("th",[t._v("Kalalaji")]),i("th",[t._v("Pistekerroin")]),i("th",[t._v("Alamitta")]),t.basic_info_validated?t._e():i("th",[t._v("Poista?")])])]),i("tbody",t._l(t.inputs,(function(e,a){return i("tr",{key:a},[i("th",{staticStyle:{border:"1px solid black"},attrs:{scope:"row"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Nimi",disabled:t.basic_info_validated,rules:t.rules,counter:t.max_input},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"input.name"}})],1),i("td",{staticStyle:{border:"1px solid black"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Kerroin",maxlength:"4","append-outer-icon":"add","prepend-icon":"remove",counter:3,rules:t.number_rules,disabled:t.basic_info_validated},on:{"click:append-outer":function(t){parseInt(e.multiplier)>=1?e.multiplier+=.5:e.multiplier=1},"click:prepend":function(t){e.multiplier>=1.5?e.multiplier-=.5:e.multiplier=1},paste:function(t){t.preventDefault()},keypress:function(e){return t.isNumber(e,!0)}},model:{value:e.multiplier,callback:function(i){t.$set(e,"multiplier",i)},expression:"input.multiplier"}})],1),i("td",{staticStyle:{border:"1px solid black"}},[i("v-text-field",{attrs:{dark:t.$store.getters.getTheme,label:"Alamitta (cm)",maxlength:40,disabled:t.basic_info_validated,rules:t.rules,counter:40},model:{value:e.minsize,callback:function(i){t.$set(e,"minsize",i)},expression:"input.minsize"}})],1),t.basic_info_validated?t._e():i("td",{staticStyle:{border:"1px solid black"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",color:"red darken-4",disabled:t.basic_info_validated},on:{click:function(i){return t.deleteFish(a,e.original_name,!1)}}},[i("i",{staticClass:"material-icons left"},[t._v("remove_circle")]),t._v("Poista")])],1)])})),0)])])],1),t.basic_info_validated?t._e():i("v-row",[i("v-col",[i("v-btn",{staticClass:"white--text",attrs:{large:"",color:"green darken-4"},on:{click:t.addInput}},[i("v-icon",{attrs:{color:"green lighten-2"}},[t._v("mdi-plus-circle")]),t._v(" Lisää kala")],1)],1)],1),t.basic_info_validated?t._e():i("v-row",[t.competition?i("v-col",{attrs:{md:"6"}},[i("v-btn",{attrs:{large:"",color:"yellow"},on:{click:t.setOriginalValues}},[i("v-icon",{attrs:{color:"red darken-2"}},[t._v("mdi-cancel")]),t._v(" Peruuta muutokset")],1)],1):t._e(),t.competition?i("v-col",{attrs:{md:"6"}},[i("v-btn",{attrs:{large:"",color:"green"},on:{click:t.checkBasicInformation}},[i("v-icon",{attrs:{color:"green darken-4"}},[t._v("mdi-check-outline")]),t._v(" Tallenna muutokset")],1)],1):t._e()],1)],1),t.basic_info_validated?i("v-row",[i("v-col",{staticStyle:{"margin-top":"20px"}},[i("v-btn",{attrs:{large:"",tile:"",color:"grey"},on:{click:function(e){t.basic_info_validated=!1}}},[i("i",{staticClass:"material-icons left"},[t._v("settings")]),t._v("Muuta tietoja")])],1)],1):t._e()],1)],1)])],1)],1)],1)},s=[],n=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("c975"),i("a434"),i("b0c0"),i("a9e3"),i("d3b7"),i("25f0"),i("6062"),i("3ca3"),i("159b"),i("ddb0"),i("ade3")),o=i("2909"),r=(i("96cf"),i("1da1")),l=i("4d5c"),c=i.n(l),u=i("96c7"),p=i("7149"),m=i("51dd"),d=i("a822"),v={name:"CompSettings",components:{ProgressBarQuery:d["default"],Header:u["default"]},data:function(){var t=this;return{dialog:!1,errors:[],cups:[],cup:{},competition:null,name:null,locality:null,cup_placement_points:null,cup_participation_points:null,cup_points_multiplier:null,team_competition:null,fish_specs:null,start_date:null,end_date:null,formatted_start_date:null,formatted_end_date:null,start_time:null,end_time:null,loading:!1,loading_cups:!1,updating:!1,tab:null,basic_info_validated:!0,inputs:[],rules:[function(t){return!!t||"Kenttä ei voi jäädä tyhjäksi!"},function(e){return(e||"").length<=t.max_input||"Enintään 40 merkkiä"}],number_rules:[function(t){return!!t||"Kenttä ei voi jäädä tyhjäksi!"},function(t){return!isNaN(t||"")||"Ei ole numero!"},function(t){return(t||"")>=0||"Numeron pitää olla positiivinen!"}],max_input:40,placement_points_array:[{points:35,placement:1},{points:33,placement:2},{points:31,placement:3},{points:29,placement:4},{points:27,placement:5},{points:25,placement:6},{points:24,placement:7},{points:23,placement:8},{points:22,placement:9},{points:21,placement:10},{points:20,placement:11},{points:19,placement:12},{points:18,placement:13},{points:17,placement:14},{points:16,placement:15},{points:15,placement:16},{points:14,placement:17},{points:13,placement:18},{points:12,placement:19},{points:11,placement:20},{points:10,placement:21},{points:9,placement:22},{points:8,placement:23},{points:7,placement:24},{points:6,placement:25},{points:5,placement:26}],selectedItem:1,items:[{text:"Yleisnäkymä",icon:"mdi-desktop-mac-dashboard",path:"/overview"},{text:"Määritykset",icon:"mdi-tune",path:"/comp-settings"},{text:"Ilmoittautuminen",icon:"mdi-draw",path:"/signing"},{text:"Punnitus",icon:"mdi-dumbbell",path:"/weighting"},{text:"Tulokset",icon:"mdi-seal",path:"/results"}]}},created:function(){if(this.checkLogin(),null!=localStorage.getItem("competition")){var t=JSON.parse(localStorage.getItem("competition")),e=t["id"];this.refreshCompetition(e)}else console.log("No competition in localstorage!");location.href="#",location.href="#app"},mounted:function(){},methods:{changePage:function(t){this.$router.currentRoute.path!==t?(this.$router.push(t),this.drawer=!this.drawer):c.a.toast({html:"Olet jo tällä sivulla!"})},checkLogin:function(){var t=JSON.parse(localStorage.getItem("user")),e=localStorage.getItem("jwt");null!=t&&null!=e?(this.$store.state.logged_in=!0,1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1):(t&&localStorage.removeItem("user"),e&&localStorage.removeItem("jwt"),this.$store.state.logged_in=!1,this.$store.state.is_admin=!1,c.a.toast({html:"Tapahtui virhe... Kirjaudu sisään uudestaan"}))},publishCompetition:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:e.competition.isPublic=!t,a={$set:{isPublic:e.competition.isPublic}},e.updateToDatabase(e.competition,a);case 3:case"end":return i.stop()}}),i)})))()},endCompetition:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:e.competition.isFinished=!t,e.competition.isFinished?e.competition.state="Päättynyt":e.competition.state="Kesken",a={$set:{isFinished:e.competition.isFinished}},e.updateToDatabase(e.competition,a);case 4:case"end":return i.stop()}}),i)})))()},updateToDatabase:function(t,e){var i=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,i.$store.commit("refreshCompetition",t),i.updating=!0,a.next=5,p["a"].updateValues(i.competition._id,e);case 5:a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),console.error(a.t0.message);case 10:i.updating=!1;case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))()},getCups:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading_cups=!0,i=JSON.parse(localStorage.getItem("user")),a=i["id"],e.prev=3,e.next=6,m["a"].getCups({user_id:a});case 6:t.cups=e.sent,t.cups.length&&(t.cups.sort((function(t,e){return t.name-e.name})),t.cups.forEach((function(t){t.select="".concat(t.name," (").concat(t.year,")")})),s=t.cups.find((function(e){return t.competition.cup_id===e.id})),s?t.cup=s:console.log("No cup found on competition!")),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),t.error=e.t0.message;case 13:t.loading_cups=!1;case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))()},refreshCompetition:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a,s,n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.loading=!0,e.inputs=[],i.prev=2,i.next=5,p["a"].getCompetitions({_id:t});case 5:a=i.sent,a?(e.competition=a,e.$store.commit("refreshCompetition",a),e.fish_specs=e.$store.getters.getCompetitionFishes,s=e.$moment(e.competition.start_date),n=e.$moment(e.competition.end_date),e.formatted_start_date="".concat(s.date(),".").concat(s.month()+1,".").concat(s.year()),e.formatted_end_date="".concat(n.date(),".").concat(n.month()+1,".").concat(n.year()),e.setOriginalValues(),e.cups.length||e.getCups()):console.log("No competition found on database..."),i.next=12;break;case 9:i.prev=9,i.t0=i["catch"](2),console.error(i.t0.message);case 12:e.loading=!1;case 13:case"end":return i.stop()}}),i,null,[[2,9]])})))()},isNumber:function(t,e){var i=46,a=".";e||(i=58,a=":"),t=t||window.event;var s=t.which?t.which:t.keyCode;if(s>31&&(s<48||s>57)&&s!==i)t.preventDefault();else{if(s!=i)return!0;if(!(t.target.value.indexOf(a)>=0))return!0;t.preventDefault()}},addInput:function(){this.inputs.push({name:null,multiplier:1,minsize:0,weights:0,color:this.generateRandomColor()})},deleteFish:function(t,e,i){var a=this;if(i)try{this.inputs.splice(t,1),this.competition.signees.forEach((function(t){if(t.weights.length){var i=t.weights.findIndex((function(t){return t.name===e}));i>-1&&t.weights.splice(i,1)}}))}catch(s){console.error=s.message}else this.$confirm("Oletko varma?","Poista kala","question").then((function(i){i&&a.deleteFish(t,e,i)})).catch((function(t){t&&console.error(t)}))},setOriginalValues:function(){var t=this;this.inputs=[],this.fish_specs.forEach((function(e){t.inputs.push({name:e.name,multiplier:parseInt(e.multiplier),minsize:e.minsize,weights:parseInt(e.weights),color:e.color,original_name:e.name,original_multiplier:parseInt(e.multiplier),original_minsize:e.minsize})})),this.name=this.competition.name,this.locality=this.competition.locality,this.cup_participation_points=this.competition.cup_participation_points,this.cup_placement_points=this.competition.cup_placement_points,this.cup_points_multiplier=this.competition.cup_points_multiplier,this.team_competition=this.competition.team_competition?"Kyllä":"Ei",this.start_date=new Date(this.competition.start_date).toISOString().substr(0,10),this.end_date=new Date(this.competition.end_date).toISOString().substr(0,10),this.start_time=this.competition.start_time,this.end_time=this.competition.end_time,this.basic_info_validated=!0},generateRandomColor:function(){var t="#"+Math.floor(16777215*Math.random()).toString(16);return t},showError:function(t){this.errors.push(t),c.a.toast({html:t}),location.href="#",location.href="#app"},checkBasicInformation:function(){var t=this;this.errors=[],this.basic_info_validated=!1,this.validated=!1;var e=this.$moment(this.start_date,"YYYY-M-D",!0).isValid(),i=this.$moment(this.end_date,"YYYY-M-D",!0).isValid(),a=this.$moment(this.start_time,"H:mm",!0).isValid(),s=this.$moment(this.end_time,"H:mm",!0).isValid();if(this.name||this.showError("Kilpailun nimi puuttuu!"),this.locality||this.showError("Kilpailun paikkakunta puuttuu!"),this.cup.id||this.showError("Cuppia ei valittuna!"),this.cup_placement_points||this.showError("Määritä kilpailun voittajalle Cup sijoittumispisteet (Voittaja saa pisteet: Sijoittumispisteet + Osallistumispisteet)!"),this.cup_participation_points||this.showError("Määritä kilpailun Cup osallistumispisteet!"),this.cup_points_multiplier||this.showError("Kilpailun pistekerroin puuttuu!"),this.cup_points_multiplier<.1&&this.showError("Kilpailun pistekerroin pitää olla vähintään 0.1!"),this.start_time&&a||(1==!this.start_time?this.showError("Kilpailun alkamisnaika puuttuu!"):this.showError('Syötä aika muodossa "hh:mm" (esim: 13:00). Syötetty aika oli: '+this.start_time)),this.end_time&&s||(1==!this.end_time?this.showError("Kilpailun loppumisaika puuttuu!"):this.showError('Syötä aika muodossa "hh:mm" (esim: 13:00). Syötetty aika oli: '+this.end_time)),this.start_date&&e||(1==!this.start_date?this.showError("Päivämäärää ei ole valittu!"):this.showError('Syötä päivämäärä muodossa "PP.KK.VVVV (esim: 06.02.2020)')),this.end_date&&i){var r=this.$moment(this.start_date).format("DD.MM.YYYY"),l=this.$moment(this.end_date).format("DD.MM.YYYY"),c=this.$moment("".concat(r," ").concat(this.start_time),"DD.MM.YYYY HH:mm"),u=this.$moment("".concat(l," ").concat(this.end_time),"DD.MM.YYYY HH:mm");u.isBefore(c,"minutes")&&this.showError("Kilpailun päättymispäivämäärä ja kellonaika ei voi olla ennen alkamispäivämäärää!")}else 1==!this.end_date?this.showError("Päivämäärää ei ole valittu!"):this.showError('Syötä päivämäärä muodossa "PP.KK.VVVV (esim: 06.02.2020)');if(this.inputs.forEach((function(e){e.name||t.showError("Kalan nimi on jäänyt tyhjäksi!"),e.multiplier||t.showError("".concat(e.name?e.name:"Kalan"," kerroin on jäänyt tyhjäksi!")),e.minsize||t.showError("".concat(e.name?e.name:"Kalan"," alamitta on jäänyt tyhjäksi!"))})),!this.errors.length){var p=this.$moment(this.start_date).format("DD.MM.YYYY"),m=this.$moment(this.end_date).format("DD.MM.YYYY"),d=this.$moment("".concat(p," ").concat(this.start_time),"DD.MM.YYYY HH:mm"),v=this.$moment("".concat(m," ").concat(this.end_time),"DD.MM.YYYY HH:mm");this.competition.cup_id=this.cup.id,this.competition.cup_name=this.cup.name,this.competition.name=this.name,this.competition.locality=this.locality,this.competition.cup_placement_points=Number(this.cup_placement_points),this.competition.cup_participation_points=Number(this.cup_participation_points);var _=[];if(this.competition.cup_points_multiplier!==this.cup_points_multiplier&&1!==this.cup_points_multiplier){var h=1;this.placement_points_array.forEach((function(e){_.push({placement:h,points:(e.points-t.competition.cup_participation_points)*t.cup_points_multiplier+t.competition.cup_participation_points}),h++}))}else _=Object(o["a"])(this.placement_points_array);this.competition.cup_points_multiplier=this.cup_points_multiplier,this.competition.cup_placement_points_array=_,this.competition.team_competition="Ei"!==this.team_competition,this.competition.start_date=d,this.competition.end_date=v,this.competition.start_time=this.start_time,this.competition.end_time=this.end_time,this.competition.signees.forEach((function(e){e.weights.length&&t.inputs.forEach((function(i){if(i.name!==i.original_name||i.multiplier!==i.original_multiplier||i.minsize!==i.original_minsize){var a=e.weights.findIndex((function(t){return t.name===i.original_name}));if(a>-1){if(e.weights[a].name=i.name,e.total_points-=e.weights[a].points,e.weights[a].points=e.weights[a].weights*i.multiplier,e.total_points+=e.weights[a].points,t.competition.normal_weights.length){var s=t.competition.normal_weights.findIndex((function(t){return parseInt(t.boat_number)===parseInt(e.boat_number)}));if(s>-1){var o=t.competition.normal_weights[s];o.total_points=e.total_points,i.name!==i.original_name&&(console.log(i.name,i.original_name),delete Object.assign(o,Object(n["a"])({},i.name,o[i.original_name]))[i.original_name])}var r=t.competition.normal_points.findIndex((function(t){return parseInt(t.boat_number)===parseInt(e.boat_number)}));if(r>-1){var l=t.competition.normal_points[r];l.total_points=e.total_points}}}else e.weights.push({name:i.name,weights:0,points:0})}}))})),this.inputs.forEach((function(e){e.name!==e.original_name&&(t.competition.biggest_fishes[e.original_name]&&delete Object.assign(t.competition.biggest_fishes,Object(n["a"])({},e.name,t.competition.biggest_fishes[e.original_name]))[e.original_name],t.competition.biggest_amounts[e.original_name]&&delete Object.assign(t.competition.biggest_amounts,Object(n["a"])({},e.name,t.competition.biggest_amounts[e.original_name]))[e.original_name],e.original_name=e.name,e.original_multiplier=e.multiplier,e.original_minsize=e.minsize)})),this.competition.fishes=this.fish_specs=this.inputs;var g=this.calculateNormalResults(this.competition);this.competition.normal_points=g.normal_points,this.competition.normal_weights=g.normal_weights,this.competition.team_competition&&(this.competition.team_results=this.calculateTeamResults()),this.updateCompetition(this.competition),this.basic_info_validated=!0}},updateCompetition:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,e.$store.commit("refreshCompetition",t),e.loading=!0,i.next=5,p["a"].updateCompetition(t._id,t);case 5:e.tab="show-settings",i.next=11;break;case 8:i.prev=8,i.t0=i["catch"](0),console.error(i.t0.message);case 11:e.loading=!1,c.a.toast({html:"Tiedot päivitetty tietokantaan, sekä tulokset laskettu uusilla arvoilla!"});case 13:case"end":return i.stop()}}),i,null,[[0,8]])})))()},deleteCompetition:function(t,e){var i=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e){a.next=15;break}return c.a.toast({html:"Poistetaan tietokannasta!"}),a.prev=2,a.next=5,p["a"].deleteCompetition(t);case 5:i.$store.state.competition=null,localStorage.removeItem("competition"),i.$router.push({path:"/dashboard"}),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](2),i.error=a.t0.message;case 13:a.next=16;break;case 15:i.$confirm("Oletko varma?","Poista kilpailu","question").then((function(e){e&&i.deleteCompetition(t,e)})).catch((function(t){t&&console.error(t)}));case 16:case"end":return a.stop()}}),a,null,[[2,10]])})))()},calculateNormalResults:function(t){var e,i=t.cup_points_multiplier,a=t.cup_placement_points,s=t.cup_participation_points,n=0,o=0,r=1,l=0,c=[],u=[],p=this.$store.getters.getFinishedSignees;p=p.sort((function(t,e){return parseInt(e.total_points)-parseInt(t.total_points)})),p.forEach((function(t){e=0,c.length?(t.total_points==n?(r-=1,o+=1):r+=o,0==t.total_points&&(a=0,t.total_points===n&&(o+=1)),l<=5?t.total_points!==n&&t.total_points>0&&(a-=2*(o+1),o=0):a<=0?(a=0,o=0):t.total_points!==n&&(a-=1*(o+1),o=0)):(0==t.total_points&&(a=0),n=t.total_points,e=a*i+s),e=a>0?a*i+s:s,c.push({placement:r,boat_number:t.boat_number,captain_name:t.captain_name,temp_captain_name:t.temp_captain_name,locality:t.locality,total_points:t.total_points.toLocaleString(),cup_placement_points:a*i,cup_participation_points:s,cup_points_total:e}),l++;var p={};p.placement=r,p.boat_number=t.boat_number,p.captain_name=t.captain_name,t.weights.forEach((function(t){var e=t.name,i=t.weights;p[e]=i})),p.total_points=t.total_points,u.push(p),n=t.total_points,o>0?r+=o:r++}));var m={normal_points:c,normal_weights:u};return m},calculateTeamResults:function(){var t=this.competition.signees,e=[],i=[];return t.forEach((function(t){"-"!==t.team&&null!==t.team&&e.push(t.team)})),e=Object(o["a"])(new Set(e)),e.forEach((function(e){var a=t.filter((function(t){return t.team==e})),s=0,n=[];a.forEach((function(t){n.push(t.captain_name),s+=t.total_points})),1===n.length&&(n.push("-"),n.push("-")),2===n.length&&n.push("-"),i.push({name:e,captain_name_1:n[0],captain_name_2:n[1],captain_name_3:n[2],points:s.toLocaleString()})})),i}}},_=v,h=i("2877"),g=i("6544"),f=i.n(g),b=i("0798"),k=i("8336"),w=i("b0af"),x=i("99d9"),y=i("62ad"),C=i("a523"),$=i("2e4b"),T=i("169a"),S=i("ce7e"),V=i("132d"),j=i("8860"),P=i("da13"),I=i("5d23"),K=i("1baa"),R=i("34c3"),E=i("f774"),O=i("67b6"),Y=i("43a6"),D=i("0fd9"),F=i("b974"),L=i("2fa4"),N=i("71a3"),A=i("c671"),M=i("fe57"),H=i("aac8"),B=i("9a96"),z=i("8654"),J=i("c964"),Q=Object(h["a"])(_,a,s,!1,null,null,null);e["default"]=Q.exports;f()(Q,{VAlert:b["a"],VBtn:k["a"],VCard:w["a"],VCardActions:x["a"],VCardTitle:x["c"],VCol:y["a"],VContainer:C["a"],VDatePicker:$["a"],VDialog:T["a"],VDivider:S["a"],VIcon:V["a"],VList:j["a"],VListItem:P["a"],VListItemContent:I["a"],VListItemGroup:K["a"],VListItemIcon:R["a"],VListItemSubtitle:I["b"],VListItemTitle:I["c"],VNavigationDrawer:E["a"],VRadio:O["a"],VRadioGroup:Y["a"],VRow:D["a"],VSelect:F["a"],VSpacer:L["a"],VTab:N["a"],VTabItem:A["a"],VTabs:M["a"],VTabsItems:H["a"],VTabsSlider:B["a"],VTextField:z["a"],VTimePicker:J["a"]})},c895:function(t,e,i){"use strict";var a=i("f224"),s=i.n(a);s.a},c8f6:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("Header",{staticStyle:{"margin-bottom":"60px"}}),i("v-row",{staticClass:"valign-wrapper"},[i("v-col",{attrs:{md:"3"}},[t.competition?i("v-btn",{attrs:{rounded:"",color:"yellow"},on:{click:function(e){return t.$router.push({path:"/overview"})}}},[i("i",{staticClass:"material-icons left"},[t._v("history")]),t._v("Takaisin kilpailuun ")]):t._e()],1),i("v-col",{attrs:{md:"6"}},[i("h1",[t._v("Cupin Yleisnäkymä")])]),i("v-col",{attrs:{md:"3"}})],1),i("v-tabs",{attrs:{"background-color":"blue lighten-2",color:"blue darken-4",grow:"","show-arrows":"","next-icon":"mdi-arrow-right-bold-box-outline","prev-icon":"mdi-arrow-left-bold-box-outline","center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tabs-slider",{attrs:{color:"blue darken-4"}}),i("v-tab",{attrs:{href:"#overview"}},[t._v("Yleisnäkymä")]),i("v-tab",{attrs:{href:"#points",disabled:!t.competitions.length}},[t._v("Pistetilanne")]),i("v-tab",{attrs:{href:"#stats",disabled:!t.competitions.length}},[t._v("Tilastoja")])],1),i("v-tabs-items",{staticStyle:{background:"rgba(0,0,0,0.4)"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("v-tab-item",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},attrs:{value:"overview"}},[t.loading?i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Valmistellaan Cuppia... ")]),i("ProgressBarQuery")],1)],1):i("v-row",[t.cup?i("v-col",[i("h1",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" "+t._s(t.cup.name)+", "+t._s(t.cup.year)+" ")])]):i("v-col",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei kuppia valittuna ")])])],1),t.competitions.length?i("v-row",[i("v-col",{attrs:{md:"4","offset-md":"4"}},[i("v-select",{attrs:{dark:t.$store.getters.getTheme,"menu-props":t.$store.getters.getTheme?"dark":"light",label:"Valitse näytettävät tiedot",outlined:"",items:t.select_table},on:{input:t.selectTableData},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)],1):t._e(),t.competitions.length?i("v-row",[i("v-col",{attrs:{md:"10","offset-md":"1"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Kilpailut ")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailua","single-line":"","hide-details":""},model:{value:t.search_comp,callback:function(e){t.search_comp=e},expression:"search_comp"}})],1),i("v-data-table",{attrs:{id:"normal-table",headers:t.selected_headers,items:t.selected_items,search:t.search_comp,loading:t.loading||t.updating},scopedSlots:t._u([{key:"item.start_date",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:"primary darken-2"}},[t._v(t._s(a.start_date.format("DD.MM.YYYY")))])]}},{key:"item.isFinished",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-chip",t._g(t._b({attrs:{color:a.isFinished?"green lighten-2":"red lighten-2",outlined:t.$store.getters.getTheme,disabled:t.updating},on:{click:function(e){return t.endCompetition(a)}}},"v-chip",n,!1),s),[t._v(t._s(a.isFinished?"Kyllä":"Ei"))])]}}],null,!0)},[i("span",[t._v("Muuta tila painamalla")])])]}},{key:"item.isPublic",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-chip",t._g(t._b({attrs:{outlined:t.$store.getters.getTheme,color:a.isPublic?"green darken-2":"red darken-2",disabled:t.updating},on:{click:function(e){return t.publishCompetition(a)}}},"v-chip",n,!1),s),[t._v(t._s(a.isPublic?"Julkinen":"Salainen"))])]}}],null,!0)},[i("span",[t._v("Muuta tila painamalla")])])]}},{key:"item.cup_points_multiplier",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{color:t.getMultiplierColor(a.cup_points_multiplier),outlined:t.$store.getters.getTheme}},[t._v(t._s(a.cup_points_multiplier)+"x")])]}},{key:"item.choose",fn:function(e){var a=e.item;return[i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[i("v-btn",t._g(t._b({attrs:{color:"primary",disabled:t.updating},on:{click:function(e){return t.pickCompetition(a)}}},"v-btn",n,!1),s),[i("v-icon",{attrs:{color:"black"}},[t._v("mdi-arrow-right-bold-box-outline")])],1)]}}],null,!0)},[i("span",[t._v("Siirry kilpailuun")])])]}},{key:"item.modify",fn:function(e){var a=e.item;return[i("v-btn",{attrs:{color:"yellow darken-2",dark:t.$store.getters.getTheme},on:{click:function(e){e.stopPropagation(),t.new_captain_name=a.captain_name,t.new_temp_captain_name=a.temp_captain_name,t.new_locality=a.locality,t.$set(t.dialog_signee,a.boat_number,!0)}}},[i("v-icon",{attrs:{color:"black"}},[t._v("mdi-account-edit")])],1),i("v-dialog",{key:a.boat_number,attrs:{persistent:"","max-width":"600px"},model:{value:t.dialog_signee[a.boat_number],callback:function(e){t.$set(t.dialog_signee,a.boat_number,e)},expression:"dialog_signee[item.boat_number]"}},[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("span",{staticClass:"headline"},[t._v("Muokkaa käyttäjän (Nro "+t._s(a.boat_number)+") Cup tietoja")])]),i("v-card-text",[i("v-container",[t.errors.length?i("div",[i("ul",{staticClass:"collection with-header",staticStyle:{border:"1px solid red"}},[i("li",{staticClass:"collection-header",staticStyle:{background:"rgba(0,0,0,0)"}},[i("v-alert",{attrs:{type:"error"}},[t._v(" Korjaa seuraavat virheet: ")])],1),t._l(t.errors,(function(e,a){return i("li",{key:a,staticClass:"collection-item",attrs:{id:"error"}},[i("p",{staticClass:"flow-text black--text"},[t._v(" "+t._s(a+1)+". "+t._s(e)+" ")])])}))],2)]):t._e(),i("v-row",[i("v-col",{attrs:{cols:"12",sm:"6",md:"10"}},[i("v-text-field",{attrs:{loading:t.publishing,label:"Kippari*",maxlength:"40",counter:"40",required:""},model:{value:t.new_captain_name,callback:function(e){t.new_captain_name=e},expression:"new_captain_name"}})],1)],1),i("v-row",[i("v-col",{attrs:{cols:"12",sm:"6",md:"10"}},[i("v-text-field",{attrs:{loading:t.publishing,label:"Varakippari",maxlength:"40",counter:"40",required:""},model:{value:t.new_temp_captain_name,callback:function(e){t.new_temp_captain_name=e},expression:"new_temp_captain_name"}})],1)],1),i("v-row",[i("v-col",{attrs:{cols:"12",sm:"6",md:"10"}},[i("v-text-field",{attrs:{loading:t.publishing,label:"Paikkakunta*",maxlength:"40",counter:"40",required:""},model:{value:t.new_locality,callback:function(e){t.new_locality=e},expression:"new_locality"}})],1)],1),i("small",[t._v("*Pakolliset kentät")])],1)],1),i("v-card-actions",[i("v-btn",{attrs:{color:"yellow darken-2",outlined:"",loading:t.publishing},on:{click:function(e){return e.stopPropagation(),t.modifySignee(a,t.new_captain_name,t.new_temp_captain_name,t.new_locality,!1)}}},[t._v("Peruuta")]),i("v-spacer"),i("v-btn",{attrs:{color:"green darken-2",outlined:"",loading:t.publishing},on:{click:function(e){return e.stopPropagation(),t.modifySignee(a,t.new_captain_name,t.new_temp_captain_name,t.new_locality,!0)}}},[t._v("Tallenna")])],1)],1)],1)]}}],null,!0)})],1)],1)],1):t._e(),t.competitions.length?i("v-row",[i("v-col",{staticStyle:{"margin-top":"20px"}},[i("v-btn",{attrs:{tile:"",color:"blue lighten-1",loading:t.publishing},on:{click:function(e){return t.changePage("/register-comp")}}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Luo uusi kilpailu!")])],1),i("v-col",{staticStyle:{"margin-top":"20px"}},[i("v-btn",{attrs:{large:"",outlined:"",dark:t.$store.getters.getTheme,loading:t.publishing},on:{click:function(e){return t.saveAsPDF("Ilmoittautuneet")}}},[i("v-icon",{attrs:{color:"red"}},[t._v("mdi-file-pdf-outline")]),t._v(" Lataa lista kilpailijoista")],1)],1),i("v-col",{staticStyle:{"margin-top":"20px"}},[i("v-btn",{staticClass:"white--text",attrs:{large:"",tile:"",color:t.cup.isPublic?"grey darken-4":"green darken-4",loading:t.publishing},on:{click:function(e){return t.publishCup(t.cup.isPublic)}}},[t.cup.isPublic?i("div",[i("v-icon",[t._v("mdi-incognito")]),t._v(" Aseta cup salaiseksi ")],1):i("div",[i("v-icon",{attrs:{color:"green"}},[t._v("mdi-publish")]),t._v(" Aseta cup julkiseksi ")],1)])],1)],1):i("v-row",[t.loading||t.competitions.length?t._e():i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei kilpailuja! ")]),i("router-link",{attrs:{to:"/register-comp"}},[i("v-btn",{attrs:{tile:"",color:"blue lighten-1"}},[i("i",{staticClass:"material-icons left"},[t._v("add_circle_outline")]),t._v("Luo kilpailu!")])],1)],1),t.error?i("v-col",[i("h2",{staticClass:"error",class:{"white--text":t.$store.getters.getTheme}},[t._v(" "+t._s(t.error)+" ")])]):t._e(),t.loading?i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ladataan kilpailuja... ")]),i("ProgressBarQuery")],1):t._e()],1)],1),i("v-tab-item",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},attrs:{value:"points"}},[i("v-row",[i("v-col",[t.results.length?i("v-row",[i("v-col",[i("h1",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Cupin kokonaispisteet ")])])],1):t._e(),t.results.length?i("v-row",{class:{inputarea:!t.$store.getters.getTheme,"inputarea-dark":t.$store.getters.getTheme},staticStyle:{"padding-top":"25px"}},[i("v-col",{staticClass:"d-flex",attrs:{md:"4"}},[i("v-select",{attrs:{"menu-props":t.$store.getters.getTheme?"dark":"light",dark:t.$store.getters.getTheme,items:t.header_options,label:"Kilpailun otsikko",outlined:""},on:{input:t.changeHeaders},model:{value:t.header_selection,callback:function(e){t.header_selection=e},expression:"header_selection"}})],1),i("v-col",{staticClass:"d-flex",attrs:{md:"4"}},[i("v-select",{attrs:{"menu-props":t.$store.getters.getTheme?"dark":"light",dark:t.$store.getters.getTheme,items:t.select_numbers,label:"Cup sijoittumispisteisiin vaikuttavien kilpailujen määrä",outlined:""},on:{input:function(e){return t.calculateAll(t.competitions,t.selected_competitions)}},model:{value:t.selected_competitions,callback:function(e){t.selected_competitions=e},expression:"selected_competitions"}})],1),i("v-col",{attrs:{md:"4"}},[i("v-btn",{attrs:{large:"",outlined:"",dark:t.$store.getters.getTheme,loading:t.loading},on:{click:function(e){return t.saveAsPDF("Tulokset")}}},[i("v-icon",{attrs:{color:"red"}},[t._v("mdi-file-pdf-outline")]),t._v(" Lataa pdf ")],1)],1)],1):t._e(),t.results.length&&t.not_finished_count>0?i("v-row",[i("v-col",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" *Punaisella merkityt kilpailut ovat vielä kesken! ("+t._s(t.not_finished_count)+" kpl) ")])])],1):t._e(),t.isResults?i("v-row",[i("v-col",[i("v-card",{attrs:{dark:t.$store.getters.getTheme}},[i("v-card-title",[i("p",{staticClass:"flow-text"},[t._v("Cupin kokonaispisteet")]),i("v-spacer"),i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Hae kilpailijaa","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),i("v-data-table",{attrs:{id:"normal-table",headers:t.headers,items:t.results,search:t.search,loading:t.loading},scopedSlots:t._u([t._l(t.headers,(function(e,a){return{key:"header."+e.value,fn:function(e){var s=e.header;return[s.highlight?i("span",{key:a,staticClass:"strokeme",class:{"red-text":s.isFinished,"green-text":!s.isFinished}},[t._v(" "+t._s(s.text)+" ")]):i("span",{key:a},[t._v(t._s(s.text))])]}}})),{key:"item.final_placement",fn:function(e){var a=e.item;return[i("v-chip",{attrs:{outlined:t.$store.getters.getTheme,color:t.getColor(a.final_placement)}},[t._v(t._s(a.final_placement)+".")])]}},t._l(t.competitions.length,(function(e,a){return{key:"item.cup_results["+e+"].points",fn:function(s){var n=s.item;return[n.cup_results[e]?i("div",{key:e},[n.cup_results[e].points===t.competitions[a].cup_participation_points?i("span",{staticClass:"strokeme"},[t._v(t._s(n.cup_results[e].points)+"p ("+t._s(n.cup_results[e].placement)+".)")]):i("span",{staticClass:"strokeme",class:"font-weight-bold text-outline  "+t.getColor(n.cup_results[e].placement)+"-text"},[t._v(t._s(n.cup_results[e].points)+"p ("+t._s(n.cup_results[e].placement)+".)")])]):i("span",{key:e},[t._v(" - ")])]}}})),{key:"item.final_cup_points",fn:function(e){var a=e.item;return[i("span",{staticClass:"indigo-text"},[t._v(t._s(a.final_cup_points)+"p")])]}}],null,!0)})],1)],1)],1):i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Kilpailuissa ei vielä tuloksia! ")])])],1),t.competitions.length&&t.cup?i("v-row",[t.loading?i("v-col",[i("p",{staticClass:"flow-text",class:{"white--text":t.$store.getters.getTheme}},[t._v(" Päivitetään tuloksia... ")])]):t._e()],1):t._e(),t.competitions.length&&t.cup?i("v-row",[i("v-col",[i("v-btn",{staticClass:"white--text",attrs:{id:"updatebtn",large:"",tile:"",loading:t.loading,disabled:!t.isResults,color:"blue darken-4"},on:{click:function(e){return t.refreshCup(t.cup.id)}}},[i("i",{staticClass:"material-icons left"},[t._v("update")]),t._v("Päivitä cupin tulokset ")])],1)],1):i("v-row",[i("v-col",[i("h2",{class:{"white--text":t.$store.getters.getTheme}},[t._v(" Ei kilpailuja rekisteröitynä! ")])])],1)],1)],1)],1),i("v-tab-item",{class:{"container-transparent":!t.$store.getters.getTheme,"container-transparent-dark":t.$store.getters.getTheme},attrs:{value:"stats"}},[i("v-row",[i("v-col",[i("h1",[t._v("Tilastoja (Coming soon...)")])])],1),i("v-row",[i("v-col",[i("h2",[t._v("Contenttia")])])],1)],1)],1)],1)},s=[],n=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("a15b"),i("d81d"),i("fb6a"),i("a434"),i("b0c0"),i("a9e3"),i("4fad"),i("d3b7"),i("07ac"),i("ac1f"),i("3ca3"),i("5319"),i("1276"),i("159b"),i("ddb0"),i("b85c")),o=i("2909"),r=(i("96cf"),i("1da1")),l=i("4d5c"),c=i.n(l),u=i("51dd"),p=i("7149"),m=i("e511"),d=i.n(m),v=(i("0da4"),regeneratorRuntime.mark(h)),_={name:"CupOverview",components:{ProgressBarQuery:function(){return Promise.resolve().then(i.bind(null,"a822"))},Header:function(){return Promise.resolve().then(i.bind(null,"96c7"))}},data:function(){return{dialog_clock:!1,dialog_signee:{},cup:null,competitions:[],signees:[],headers:[],select_table:["Kilpailut","Ilmoittautuneet"],selected:"Kilpailut",selected_headers:[],selected_items:[],headers_comp:[{text:"Kilpailun Päivämäärä",value:"start_date"},{text:"Nimi",value:"name"},{text:"Päättynyt",value:"isFinished"},{text:"Julkisuus",value:"isPublic"},{text:"Pistekerroin",value:"cup_points_multiplier"},{text:"Valitse",value:"choose",sortable:!1}],headers_signees:[{text:"Kilp. numero",value:"boat_number"},{text:"Kippari",value:"captain_name"},{text:"Varakippari",value:"temp_captain_name"},{text:"Seura/Paikkakunta",value:"locality"},{text:"Muokkaa",value:"modify",sortable:!1}],results:[],isResults:!1,loading:!1,publishing:!1,updating:!1,select_numbers:[],header_options:["Paikkakunta","Kilpailun nimi"],header_selection:"Paikkakunta",selected_competitions:0,tab:null,search:"",search_comp:"",not_finished_count:0,competition:null,error:null,errors:[],new_locality:null,new_captain_name:null,new_temp_captain_name:null,isSimpleMode:!0}},created:function(){},mounted:function(){this.competition=localStorage.getItem("competition"),this.checkLogin(),null!=localStorage.getItem("cup")?(this.refreshCup(localStorage.getItem("cup")),this.$store.state.cup=this.cup):console.log("No cup in localstorage!"),location.href="#",location.href="#app"},methods:{publishCup:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.cup.isPublic=!t,i.prev=1,e.$store.state.cup=e.cup,e.publishing=!0,a={$set:{isPublic:e.cup.isPublic}},i.next=7,u["a"].updateValues(e.cup.id,a);case 7:i.next=12;break;case 9:i.prev=9,i.t0=i["catch"](1),console.error(i.t0.message);case 12:e.publishing=!1;case 13:case"end":return i.stop()}}),i,null,[[1,9]])})))()},publishCompetition:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.isPublic=!t.isPublic,a={$set:{isPublic:t.isPublic}},e.updateToDatabase(t,a);case 3:case"end":return i.stop()}}),i)})))()},endCompetition:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.isFinished=!t.isFinished,t.isFinished?t.state="Päättynyt":t.state="Kesken",a={$set:{isFinished:t.isFinished}},e.updateToDatabase(t,a);case 4:case"end":return i.stop()}}),i)})))()},updateToDatabase:function(t,e){var i=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,i.updating=!0,a.next=4,p["a"].updateValues(t._id,e);case 4:a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),console.error(a.t0.message);case 9:i.updating=!1;case 10:case"end":return a.stop()}}),a,null,[[0,6]])})))()},changePage:function(t){this.$router.push({path:t,query:{cup:localStorage.getItem("cup")}})},selectTableData:function(){"Kilpailut"===this.selected?(this.selected_items=this.competitions,this.selected_headers=this.headers_comp):(this.selected_items=this.signees,this.selected_headers=this.headers_signees)},modifySignee:function(t,e,i,a,s){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){var l,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n.errors=[],!s){r.next=24;break}if(e?t.captain_name=n.capitalize_words(t.captain_name):n.errors.push("Kipparin nimi puuttuu!"),i?t.temp_captain_name=n.capitalize_words(t.temp_captain_name):i=t.temp_captain_name="-",a?t.locality=n.capitalize_words(t.locality):n.errors.push("Seura/Paikkakunta puuttuu!"),n.errors.length){r.next=22;break}if(t.captain_name===e&&t.temp_captain_name===i&&t.locality===a){r.next=20;break}return t.captain_name=e,t.temp_captain_name=i,t.locality=a,n.$store.state.cup=n.cup,n.publishing=!0,l=Object(o["a"])(n.signees),l.forEach((function(t){delete t.dialog})),p={$set:{signees:n.signees}},r.next=17,u["a"].updateValues(n.cup.id,p).then((function(){n.calculateAll(n.competitions,n.selected_competitions),n.$set(n.dialog_signee,t.boat_number,!1),c.a.toast({html:"Kilpailijan tiedot päivitetty!"})})).catch((function(t){c.a.toast({html:"Virhe kilpailijan tietojen päivityksessä... Yritä uudelleen!"}),console.log(t)}));case 17:n.publishing=!1,r.next=22;break;case 20:c.a.toast({html:"Kaikki tiedot ovat samoja kuin aikaisemmin, poistutaan..."}),n.$set(n.dialog_signee,t.boat_number,!1);case 22:r.next=25;break;case 24:n.$set(n.dialog_signee,t.boat_number,!1);case 25:case"end":return r.stop()}}),r)})))()},capitalize_words:function(t){return t.replace(/(?:^|\s|['`‘’.-])[^\x60^\x7B-\xDF](?!(\s|$))/g,(function(t){return t.toUpperCase()}))},calculateAll:function(t,e){var i=this,a=[];if(this.isResults=!1,this.limiting=!0,t.forEach((function(t){t.normal_points.length&&t.normal_points.forEach((function(e){var s=a.findIndex((function(t){return parseInt(e.boat_number)===parseInt(t.boat_number)}));if(s>-1){var n=a[s];n.points_compare.push(e.cup_points_total),n.cup_results[t.key_name]={points:e.cup_points_total,placement:e.placement},a.splice(s,1,n)}else{var o=i.signees.find((function(t){return t.boat_number===e.boat_number}));e.captain_name=o.captain_name,e.temp_captain_name=o.temp_captain_name,e.locality=o.locality,e.cup_results=[],e.points_compare=[],e.points_compare.push(e.cup_points_total),e.cup_results[t.key_name]={points:e.cup_points_total,placement:e.placement},a.push(e)}}))})),a.length){this.isResults=!0,a=this.limitCompetitions(a,e),this.results=a.sort((function(t,e){return parseInt(e.cup_results["Total"])-parseInt(t.cup_results["Total"])})),this.changeHeaders();var s=1,n=-1,o=-1;this.results.forEach((function(t){n===t.cup_results["Total"]?t.final_placement=o:(t.final_placement=s,n=t.cup_results["Total"],o=t.final_placement),t.final_cup_points=t.cup_results["Total"],s++})),this.limiting=!1}},limitCompetitions:function(t,e){var i=this;return e=e<0?0:e,t.forEach((function(t){if(i.competitions.length>=e){t.points_compare.sort((function(t,e){return parseInt(e)-parseInt(t)})),t.cup_results["Total"]=0;var a=0;i.competitions.forEach((function(i){t.cup_results[i.key_name]&&(t.cup_results[i.key_name].placement=i.normal_points.find((function(e){return e.boat_number===t.boat_number})).placement,t.cup_results[i.key_name].points<t.points_compare[e]&&(t.cup_results[i.key_name].points=i.cup_participation_points),t.cup_results[i.key_name].points===t.points_compare[e]&&(1!==a&&(t.cup_results[i.key_name].points=i.cup_participation_points),a++))}))}t.cup_results.forEach((function(e){t.cup_results["Total"]+=e.points}))})),t},refreshCup:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.loading=!0,i.prev=1,i.next=4,u["a"].getCups({_id:t});case 4:if(a=i.sent,!a){i.next=26;break}return e.cup=a,e.$store.commit("refreshCup",e.cup),i.prev=8,i.next=11,p["a"].getCompetitions({cup_id:t});case 11:e.competitions=i.sent,s=1,e.competitions.forEach((function(t){e.select_numbers.push(s),t.start_date=e.$moment(t.start_date),t.end_date=e.$moment(t.end_date),t.key_name=s,s++})),e.competitions.sort((function(t,e){return e.start_date.isBefore(t.start_date)})),e.signees=e.cup.signees.sort((function(t,e){return t.boat_number-e.boat_number})),e.signees.forEach((function(t){t.dialog=!1})),e.selected_competitions=e.competitions.length,e.calculateAll(e.competitions,e.selected_competitions),e.selectTableData(),c.a.toast({html:"Tiedot ajantasalla!"}),i.next=26;break;case 23:i.prev=23,i.t0=i["catch"](8),console.error(i.t0);case 26:i.next=31;break;case 28:i.prev=28,i.t1=i["catch"](1),console.log(i.t1.message);case 31:e.loading=!1;case 32:case"end":return i.stop()}}),i,null,[[1,28],[8,23]])})))()},checkLogin:function(){var t=JSON.parse(localStorage.getItem("user")),e=localStorage.getItem("jwt");null!=t&&null!=e?(this.$store.state.logged_in=!0,1==t.is_admin?this.$store.state.is_admin=!0:this.$store.state.is_admin=!1):(t&&localStorage.removeItem("user"),e&&localStorage.removeItem("jwt"),this.$store.state.logged_in=!1,this.$store.state.is_admin=!1,c.a.toast({html:"Tapahtui virhe... Kirjaudu sisään uudestaan"}))},pickCompetition:function(t){this.$store.state.competition=t,localStorage.setItem("competition",JSON.stringify({id:t._id,start_date:t.start_date,end_date:t.end_date})),this.$router.push({path:"/overview"})},getColor:function(t){return t>30?"red":t>20?"orange":t>5?"yellow":"green"},getMultiplierColor:function(t){return t>1?"red":1===t?"green":"grey"},replaceAllChars:function(t,e){return Object(o["a"])(t).map((function(t){for(var i in e)t==i&&(t=e[i]);return t})).join("")},changeHeaders:function(){var t=this;this.headers=[],this.headers.push({text:"Sijoitus",highlight:!1,align:"center",value:"final_placement"}),this.headers.push({text:"Kilp. Nro",align:"center",highlight:!1,value:"boat_number"}),this.headers.push({text:"Kippari",align:"center",highlight:!1,value:"captain_name"}),this.headers.push({text:"Paikkakunta",align:"center",highlight:!1,value:"locality"}),this.not_finished_count=0,this.competitions.forEach((function(e){if(e.isFinished||t.not_finished_count++,"Paikkakunta"===t.header_selection){var i=t.headers.filter((function(t){return e.locality===t.text}));if(i.length){var a=" ".concat(e.locality," #").concat(i.length+1);t.headers.push({text:a,align:"center",highlight:!0,isFinished:!e.isFinished,value:"cup_results[".concat(e.key_name,"].points")})}else t.headers.push({text:e.locality,align:"center",highlight:!0,isFinished:!e.isFinished,value:"cup_results[".concat(e.key_name,"].points")})}else t.headers.push({text:e.name,align:"center",highlight:!0,isFinished:!e.isFinished,value:"cup_results[".concat(e.key_name,"].points")})})),this.headers.push({text:"Yhteensä",align:"center",highlight:!1,value:"final_cup_points"})},replaceAll:function(t,e,i){return t.split(e).join(i)},dictToArray:function(t,e){var i=this,a=Object.entries(t),s=[],o=1,r=!1;return a.forEach((function(t){var a=Object.values(t[1]);if(1===e){a[0]=String(a[11])+".";var l=a[9];a[1]="("+String(a[1])+")",a[3]=a[4];var c=4;i.competitions.forEach((function(t){l[t.key_name]?a[c]="".concat(l[t.key_name].points,"p (").concat(l[t.key_name].placement,".)"):a[c]="-",c++})),a[c]="".concat(l["Total"],"p")}if(2===e)if(a[0]>o){r=!0;var u,p=Object(n["a"])(h(o,a[0]));try{for(p.s();!(u=p.n()).done;){var m=u.value;m===a[0]?(a[0]=String(a[0]),r=!1):(o++,s.push([String(m)+"*","","",""]))}}catch(d){p.e(d)}finally{p.f()}}else a[0]=String(a[0]);r||(o++,s.push(a))})),s},saveAsPDF:function(t){var e;e=this.competitions.length>4&&"Tulokset"===t?new d.a("landscape"):new d.a;var i,a,s,r="".concat(this.cup.name," (").concat(this.cup.year,")"),l=[],c=Object(o["a"])(this.competitions),u=c.slice().reverse().findIndex((function(t){return!0===t.isFinished})),p=c.length-1,m=u>=0?p-u:u,v=c[m]?c[m]:null,_="",g=this.$moment();v&&(_="".concat(v.name," (").concat(v.locality,")"),g=this.$moment(v.start_date));var f="".concat(g.date(),".").concat(g.month()+1,".").concat(g.year());e.setFontSize(24),e.text(13,15,r,{align:"left"}),e.line(0,20,400,20),e.setFontSize(14);var b=0;if(this.competitions.forEach((function(t){t.isFinished?0:b++})),"Tulokset"===t)i=0===b?"Tulokset ".concat(f):"Tilanne ".concat(f,", ").concat(_,"  (").concat(b," kpl kilpailuja kesken)"),e.text(13,30,i,{align:"left"}),e.text(13,40,t+" (".concat(this.selected_competitions,"/").concat(this.competitions.length," parasta kilpailua otettu huomioon)"),{align:"left"}),this.headers.forEach((function(t){l.push(t.text)})),a=this.dictToArray(this.results,1),s=45;else{i=0===b?"Cuppiin ilmoittautuneet ".concat(this.cup.year):"Cupin kilpailijat ".concat(f," ").concat(_),e.text(13,30,i,{align:"left"}),e.setFontSize(8),l=["Kilp. numero","Kippari","Varakippari","Paikkakunta"],this.signees=this.cup.signees.sort((function(t,e){return t.boat_number-e.boat_number})),a=this.dictToArray(this.signees,2);var k,w=Number(a[a.length-1][0])+1,x=Object(n["a"])(h(w,w+6));try{for(x.s();!(k=x.n()).done;){k.value;a.push([" ","","",""])}}catch(y){x.e(y)}finally{x.f()}s=37}e.autoTable({head:[l],body:a,styles:{overflow:"linebreak",halign:"justify",fontSize:"8",lineColor:"100",lineWidth:".25"},columnStyles:{text:{cellwidth:"auto"}},headStyles:{text:{cellwidth:"wrap"}},theme:"striped",pageBreak:"auto",tableWidth:"auto",startY:s,margin:{top:20}}),e.save("".concat(this.cup.year,"_").concat(this.replaceAll("Cup"," ",""),"_").concat(this.replaceAll(this.capitalize_words(t)," ",""),".pdf"))}}};function h(t,e){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t;case 2:if(t!==e){i.next=4;break}return i.abrupt("return");case 4:return i.delegateYield(h(t+1,e),"t0",5);case 5:case"end":return i.stop()}}),v)}var g=_,f=i("2877"),b=i("6544"),k=i.n(b),w=i("0798"),x=i("8336"),y=i("b0af"),C=i("99d9"),$=i("cc20"),T=i("62ad"),S=i("a523"),V=i("8fea"),j=i("169a"),P=i("132d"),I=i("0fd9"),K=i("b974"),R=i("2fa4"),E=i("71a3"),O=i("c671"),Y=i("fe57"),D=i("aac8"),F=i("9a96"),L=i("8654"),N=i("3a2f"),A=Object(f["a"])(g,a,s,!1,null,null,null);e["default"]=A.exports;k()(A,{VAlert:w["a"],VBtn:x["a"],VCard:y["a"],VCardActions:C["a"],VCardText:C["b"],VCardTitle:C["c"],VChip:$["a"],VCol:T["a"],VContainer:S["a"],VDataTable:V["a"],VDialog:j["a"],VIcon:P["a"],VRow:I["a"],VSelect:K["a"],VSpacer:R["a"],VTab:E["a"],VTabItem:O["a"],VTabs:Y["a"],VTabsItems:D["a"],VTabsSlider:F["a"],VTextField:L["a"],VTooltip:N["a"]})},f224:function(t,e,i){}}]);
//# sourceMappingURL=about~33d48c78.2d383f18.js.map